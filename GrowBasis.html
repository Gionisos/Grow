<!DOCTYPE html>
<html>
<body>
 <link rel="stylesheet" type="text/css" href="C:\Users\Pasca\Desktop\Grow files\GrowBasis.css"> 
  <link rel="stylesheet" type="text/css" href="C:\Users\Pasca\Desktop\Grow\fa fa.css"> 
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> 
  <link rel="stylesheet" type="text/css" href="C:\Users\Pasca\Desktop\Grow\jquery-ui-1.12.1\jquery-ui-1.12.1\jquery-ui.css"> 
 <script type="text/javascript" src="C:\Users\Pasca\Desktop\Grow\jquery-3.2.1.js"></script>
 <script type="text/javascript" src="C:\Users\Pasca\Desktop\Grow\jquery-ui-1.12.1\jquery-ui-1.12.1\jquery-ui.js"></script>
 <script type="text/javascript" src="C:\Users\Pasca\Desktop\Grow\jcanvas.js"></script>
 <script type="text/javascript">
 
 // top here
$(document).ready(function() {


// GENERAL VARIABLES
var victory = "There you go!",
  level = 1,             // update function
  experienceOne = 30,
  experienceOneNeeded = 50,
  experienceTwo = 18,
  experienceTwoNeeded = 50,
  health = 40,
  maxHealth = 50,
  gold = 50,
  questSet = ["socialI", "experienceI", "knowledgeI", "skillsI", "healthI"],
  questColors = ["red", "orange", "blue", "brown", "green", "yellow"],
  statName = ["social", "experience", "knowledge", "skills", "health", "other"],
  visible = "interface",
  skillsEquipped = [0, 1], // skills
  skillPoints = 10,
  skillPointsMax = 10,
  skillPointsIncrement = setInterval(skillPointsIncrement, 3500),
  currentOpponent = 1,
  negativeRecency = 0,
  petEquipped = "3",
  avatarLocation = "sideBar";


 // DAILY VARIABLES
var dailyMax = 3,
    dailyCurrent = 2,
	dailyStats = ["social", "experience", "knowledge", "skills", "health", "other"],
    dailySave = [{
      status: "active",
	  checked: false,
      id: 1,
      title: "Meditation",
      gold: 5,
	  description: "OMMMM",
	  category: "health",
	  difficulty: "easy",
      experience: 5,
      progress: 10, 
    },
	{
      status: "active",
	  checked: false,
      id: 2,
      title: "Learn something new in programming",
	  description: "GOGOGOGOGO!",
	  category: "knowledge",
	  difficulty: "hard",
      gold: 5,
      experience: 5,
      progress: 20, 
    },
	],
    dailyId = 3,
    dailiesCheckedToday = 0,
	dailySaveCurrentTemporary = "",
	dailyHoverTimer = "",
    spree = 0,
	dailyEditRightClicked = "";
 
 
 // HABIT VARIABLES
 var habitSave = [{
      id: 1,
      title: "Improve upon Quest System",
      gold: 5,
      experience: 5,
      progress: 10, 
    },
	{
      id: 2,
      title: "Improve upon To-Do-List",
      gold: 5,
      experience: 5,
      progress: 20, 
    },
	{
      id: 3,
      title: "Get out of your comfort zone",
      gold: 5,
      experience: 5,
      progress: 10, 
    },
	{
      id: 4,
      title: "Listen to Podcast",
      gold: 5,
      experience: 5,
      progress: 10, 
    },
	],
  habitId = 0,
  habitCurrent = 0,
  habitMax = 5;
   

// TODO VARIABLES
var 
  toDoMax = 0,
  masterListId = 0,
  masterListSave = [{
      masterListId: 1,
      masterListTitle: "Meditation",
	  masterListDeadline: "2017-06-27",
      gold: 5,
      experience: 5,
    },],
  toDoListSave = [];
  
  
// MARKET VARIABLES
var itemOfInterest = 0,
  buyOrder = [0,1,2,3,3,3],
  buyApproval = false,
  itemsOwned = {
  "usables": {
  "healthPotion": 3,
  "treasureChest": 10,
  "keys": 30,
  "petWhiteFood": 2,
  },
  "equipment": [3,4,5,6,7,8,9,10,11,12,13,14,15],
  "pets": [0,1,2,3],
  "customization": [],
  "backgrounds": [0,1],
  "town": [],
  },
  itemsEquipped = [],
  avatar = {
  equipped: {
    shield: "",
    weapon: {
    number: 14,
    name: "apprentice staff",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1498582495/apprentice_staff_j6u0ot.png",
    category: "weapon",
    coordinates: [105, 96],
    size: [65,56],
  },
    armor: {
    number: 15,
    name: "hitchhikers suits",
    layer: 1,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1499957110/pageArmor_xt3cww.png",
    category: "armor",
    coordinates: [108, 125],
    size: [60, 65],
	gold: 25,
  },
    helmet: "",
    shoes: ""
  },
  stats: {
    social: 5,
    experience: 1,
    knowledge: 20,
    skills: 7,
    health: 10
  }
};
  

// Arya, remove over time? 

var Arya = {
  gold: {
    "1": "http://res.cloudinary.com/gionisos/image/upload/v1489961245/coin1_lta9kt.png",
    "2": "http://res.cloudinary.com/gionisos/image/upload/v1489961252/coin2_x1upvg.png",
    "3": "http://res.cloudinary.com/gionisos/image/upload/v1489961254/coin3_yxot5a.png",
    "4": "http://res.cloudinary.com/gionisos/image/upload/v1489961256/coin4_zcpgxc.png",
    "5": "http://res.cloudinary.com/gionisos/image/upload/v1489961258/coin5_nv73vv.png"
  },
};


// VARIABLES
var itemPlayGround = [
  {
    number: 0,
	name: "chainsaw",
	layer: 4,
	source: "http://res.cloudinary.com/gionisos/image/upload/a_29/v1497786925/chainsaw_klqmdz.png",
	category: "weapon",
	coordinates: [100, 98],
	descriptionShop: "RHMMMM RHMMMM!",
	descriptionSideBar: "It's so shiny!",
    size: [55, 50],
	gold: 50,
  },
  {
    number: 1,
    name: "fancy party robes",
    layer: 1,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497446465/partyRobes_ej2rzu_tg5bps.png",
    category: "armor",
	descriptionShop: "Fancy Schmancy and a little bit of garlic",
	descriptionSideBar: "Is it going to fit?!",
    coordinates: [132, 125],
    size: [60, 32],
	gold: 10,
  },
  {
    number: 2,
    name: "weird costume",
    layer: 1,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497446755/weirdRobes_vgy0ru_quwuye.png",
    category: "armor",
	descriptionShop: "You will never get dirty with these ones!",
    coordinates: [126, 123], // y , x for whatever reasons, le me!
    size: [60, 36],
	gold: 15
  },
  {
    number: 3,
    name: "basic sword",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211196/55_9_f43pm3.png",
    category: "weapon",
    coordinates: [112, 117],
    size: [35, 35],
  },
  {
    number: 4,
    name: "fancy sword",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211188/55_10_uuuedo.png",
    category: "weapon",
    coordinates: [109, 115],
    size: [35, 35],
  },
  {
    number: 5,
    name: "rusty hat",
    layer: 2,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497210647/55_22_apqpad.png",
    category: "helmet",
    coordinates: [80, 123],
    size: [64, 44],
  },
  {
    number: 6,
    name: "viking hat",
    layer: 2,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211123/55_23_hcoanh.png",
    category: "helmet",
    coordinates: [78, 123],
    size: [65, 45],
  },
  {
    number: 7,
    name: "Axe",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211178/55_11_jgeinf.png",
    category: "weapon",
    coordinates:  [92, 102],
    size: [50, 50],
	
  },
  {
    number: 8,
    name: "warrior armor",
    layer: 2,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211148/55_18_j0wdw1.png",
    category: "armor",
    coordinates: [128, 125],
    size: [60, 37],
  },
  {
    number: 9,
    name: "Welcome to the Club",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211169/55_12_hlq2hd.png",
    category: "weapon",
	descriptionShop: "Who does not like <br> a little bit of clubbing <br> once in a while?",
    coordinates: [92, 103],
    size: [50, 50],
  },
  {
    number: 10,
    name: "fiery sword",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497211160/55_14_brpmlx.png",
    category: "weapon",
	descriptionShop: "A burning piece of steel",
    coordinates: [105, 112]	,
    size: [40, 40],	
  },
  {
    number: 11,
    name: "golden shield",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497212849/latest_19_gnx49k.png",
    category: "shield",
    coordinates: [125, 150],
    size: [40, 40],	
  },
  {
    number: 12,
    name: "apprentice robe",
    layer: 1,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1498582495/apprentice_robe_xzmad0.png",
    category: "armor",
    coordinates: [116, 130],
    size: [50, 60],
	gold: 25,
  },
  {
    number: 13,
    name: "apprentice hat",
    layer: 2,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1498582495/apprentice_hat_azxwzy.png",
    category: "helmet",
    coordinates: [78, 123],
    size: [65, 45],
	gold: 20,
  },
  {
    number: 14,
    name: "apprentice staff",
    layer: 4,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1498582495/apprentice_staff_j6u0ot.png",
    category: "weapon",
    coordinates: [105, 96],
    size: [65,56],
	gold: 15,
  },
  {
    number: 15,
    name: "hitchhikers suits",
    layer: 1,
    source: "http://res.cloudinary.com/gionisos/image/upload/v1499957110/pageArmor_xt3cww.png",
    category: "armor",
    coordinates: [108, 125],
    size: [60, 65],
	gold: 25,
  },
  
];


// AVATAR BACKGROUND VARIABLES
var avatarBackground = [
  {
    number: 0,
    name: "background-red",
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497443338/BackgroundRed_nzpixc.png",
    category: "background",
    size: [100, 100],
  },{
    number: 1,
    name: "background-yellow",
    source: "http://res.cloudinary.com/gionisos/image/upload/v1497785371/BackgroundYellow_nzpixc_gcbil8.png",
    category: "background",
    size: [100, 100],
  }],
  backgroundsOwned = [];


// PET VARIABLES
var pet = [{  
    name: "Dressed-up water melon",
	number: 0,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1497446465/verkleidete_Wassermelone_fgucfh_qswtyf.png",
    layer: 5,
    coordinates: [138, 80],
    size: [52, 45],
	equipped: false,
  },{
    name: "white fox",
	number: 1,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1497446465/whitefox_hfsbft_j0iojq.png",
	layer: 5,
    coordinates: [138, 80],
    size: [54, 45],
	equipped: false,
  }, {  
    name: "blue fox",
	number: 2,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1498285418/foxBlue_juyx95.png",
    layer: 5,
    coordinates: [138, 80],
    size: [40, 34],
	equipped: false,
  },{
    name: "golden fox",
	number: 3,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1498285418/foxGold_lyva5x.png	",
	layer: 5,
    coordinates: [138, 80],
    size: [54, 45],
	equipped: true,
  }, {  
    name: "black bear",
	number: 4,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1498285418/BearBlack_kar4to.png",
    layer: 5,
    coordinates: [138, 80],
    size: [52, 45],
	equipped: false,
  }, {  
    name: "blue flying pig",
	number: 5,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1498285418/PigBlue_tnm2uy.png",
    layer: 5,
    coordinates: [138, 80],
    size: [85, 85],
	equipped: false,
  },{
    name: "green flying pig",
	number: 6,
	source: "http://res.cloudinary.com/gionisos/image/upload/v1498285418/PigGreen_dskhns.png",
	layer: 5,
    coordinates: [138, 80],
    size: [54, 45],
	equipped: false,
  },      
];






// TIME FUNCTIONS hier

// amount of days spent playing the game
var daysCurrent = 1;

//Attach temporary counter
$(".growContainer").append('<span class="dayCounter">'+daysCurrent+'</span>');

// Start new day
$(document).keyup(function(e) {
  if (e.keyCode === 39) {
  daysCurrent++
  }   
  startOntoANewDay();
});

//START NEW DAY FUNCTIONS

function startOntoANewDay(){
  // change text of counter
  $(".dayCounter").text(daysCurrent);
  
  // Reset Dailies - uncheck
  for(i=0;i<dailySave.length;i++){
  $.extend(true, dailySave[i], {checked: false});
  }
  // reset spree
  dailiesCheckedToday = 0;
  
  //update list again
  dailyListUpdate(true);

}
























// ARENA VARIABLES
var skills = {
  "0": {
    number: "0",
    name: "Attack",
    description: "standard attack move",
    animation: "",
    damage: "3",
    effect: "",
    cooldown: "1.6",
    skillPoints: "1"
  },
  "1": {
    number: "1",
    name: "Heal",
    description: "heal yourself",
    animation: "",
    damage: "0",
    heal: "10",
    effect: "heal",
    cooldown: "8",
    skillPoints: "4"
  },
  "2": {
    number: "2",
    name: "Jump",
    description: "jumping attack, favoribly used by blobs!",
    animation: "",
    damage: "2",
    cooldown: "2.5",
    skillPoints: "1"
  }
};

var opponent = {
  "0": {
    number: "0",
    name: "BLOB",
    description: "A wonderous creature!",
    image: "http://res.cloudinary.com/gionisos/image/upload/v1490645459/blob_ptnpes.png",
    health: "30",
    maxHealth: "30",
    attack: "5",
    defense: "2",
    skills: [2],
    skillPoints: "10"
  },
  "1": {
    number: "1",
    name: "Ninja",
    description: "A Ninja appears from the shadows!",
    image: "http://res.cloudinary.com/gionisos/image/upload/v1490692154/ninjaTest_gpvtxf.jpg",
    health: "70",
    maxHealth: "70",
    attack: "10",
    defense: "7",
    skills: [0],
    skillPoints: "14"
  }
};


// Arena weapon animation middle
var a = document.getElementById("arenaAnimationCanvas"),
    ac = a.getContext("2d"),
    $a = $("#arenaAnimationCanvas"),
  // opponent arena animation right
    oa = document.getElementById("opponentAvatarCanvas"), 
    oac = oa.getContext("2d"),
    $oa = $("#opponentAvatarCanvas");
  




// Quest system (Canvas style)
var questBeginner = {
  oneTime: [
    {
      name: "quest0",
	  id: 1,
      text: "You're simply amazing! This is the first text I am writing and I already know that you can't help but being fantastic... <br> Thank you, thank you!",
      title: "Amazing Title",
      goalText: "Write an amazing text like me! But do not write too many words, I would suggest you a mere 200 words max!",
      goalCurrent: 0,
      goalMax: 3,
      goal: "amazing texts written!",
      rewardGold: 5,
      rewardExp: 10
    },
    {
      name: "quest1",
      text: "ClickeriDooodle!",
      title: "Dooodlicious!"
    }
  ],
  town: [
  { 
    id: 2,
    name: "town0",
    title: "Social I",
	habitTitle: "Smile!",
	habit: "Smile and/or say hi to a stranger on the street (1)",
	one: "The hidden power of smiling :)",
	oneText: "Find a way to add this video here!",
	oneSource: "https://www.youtube.com/embed/U9cGdRNMdQQ",
	two: "One-time action: For today observe the reactions you get from other people when you smile at them. Try to look more closely than usual. As a second step observe how it makes you feel, when you smile, what does it do with you? On another note how does it make you feel if your smile or greeting is ignored and how can you link that to the individual need each of us has for attention",
	three: "Put something in here",
  },
  ],
};
     // Quest Canvas
var b = document.getElementById("questBeginnerCanvas"),
  bc = b.getContext("2d"),
  $b = $("#questBeginnerCanvas"),
  questBeginnerUnlocked = [0,1,2,3,4,5],
  townClicked = "",
  beginnerQuestX = [225],
  beginnerQuestY = [295],
  beginnerRoadX = [],
  beginnerRoadY = [],
  beginnerLetterX = [281],
  beginnerLetterY = [299],
  beginnerTownX = [251],
  beginnerTownY = [255],
  beginnerRewardX = [],
  beginnerRewardY = [],
  beginnerEnemyX = [170],
  beginnerEnemyY = [296],
  beginnerEnemyName = [0]; // numbers relating to opponent 0,0 = blob on enemy0

  

 // END GLOBAL VARIABLES
  
  
 // LOAD GAME
 
 function loadGame () {
 
 for (i=0;i<itemsOwned.equipment.length;i++){
 addItem(itemsOwned.equipment[i]);
 };
 
 for (i=0;i<itemsOwned.pets.length;i++) {
 addPet(itemsOwned.pets[i]);
 }
 
 
 
 for (i=0;i<itemsOwned.backgrounds.length;i++){
 addBackground(itemsOwned.backgrounds[i]);
 }

 }
  
  loadGame();
  
  
  
  
// CITY
$b.drawArc({
  strokeStyle: "steelblue",
  strokeWidth: 2,
  x: 338,
  y: 338,
  radius: 30,
  name: "village",
  layer: true
});

function loadBeginnerQuestMap() {

  for (i = 0; i < beginnerQuestX.length; i++) {
    generateQuest(beginnerQuestX[i], beginnerQuestY[i], "quest" + i, "locked");
  }
	
  
  
  
  for (i = 0; i < beginnerRoadX.length; i += 2) {
    generateRoad(
      beginnerRoadX[i],
      beginnerRoadY[i],
      beginnerRoadX[i + 1],
      beginnerRoadY[i + 1],
      "road" + i
    );
  }

  for (i = 0; i < beginnerLetterX.length; i++) {
    generateLetter(beginnerLetterX[i], beginnerLetterY[i], "letter" + i);
  }

  for (i = 0; i < beginnerTownX.length; i++) {
    generateTown(beginnerTownX[i], beginnerTownY[i], "town" + i);
  }

  for (i = 0; i < beginnerRewardX.length; i++) {
    generateReward(beginnerRewardX[i], beginnerRewardY[i], "reward" + i);
  }

  for (i = 0; i < beginnerEnemyX.length; i++) {
    generateEnemy(beginnerEnemyX[i], beginnerEnemyY[i], "enemy" + i);
  }
}

loadBeginnerQuestMap();

function generateRoad(x1, y1, x2, y2, name, status) {
  $b.drawLine({
    strokeStyle: "black",
    x1: x1,
    y1: y1,
    x2: x2,
    y2: y2,
	status: status,
    name: name,
    layer: true,
    click: function(layer) {
      console.log(name);
    }
  });
}

function generateQuest(x, y, name, status) {
  $b.drawArc({
    radius: 8,
    fillStyle: "black",
    x: x,
    y: y,
    name: name, 
	status: status,
    layer: true,
    click: function questFunction(event) {
      for (i = 0; i < questBeginner.oneTime.length; i++) {
        if (questBeginner.oneTime[i].name == event.name) {
          $(".oneTimeActionContainer").css({
            width: "768px",
            opacity: "1",
            "z-index": "11"
          });
          $(".oneTimeActionTitleContainer").html(
            "<h1>" + questBeginner.oneTime[i].title + "</h1>"
          );
          $(".oneTimeActionGoalContainer").html(
            questBeginner.oneTime[i].goalText +
              "<br><p>" +
              questBeginner.oneTime[i].goalCurrent +
              " / " +
              questBeginner.oneTime[i].goalMax +
              " " +
              questBeginner.oneTime[i].goal +
              "</p>"
          );
          $(".oneTimeActionTextContainer").html(
            "<h2>Description</h2><p>" + questBeginner.oneTime[i].text + "<p>"
          );
          $(".oneTimeActionRewardContainer").html(
            "<h2>Rewards</h2>You will receive: " +
              questBeginner.oneTime[i].rewardGold +
              " Gold!<br>Experience: " +
              questBeginner.oneTime[i].rewardExp
          );
        }
      }
    }  
  });
}

// CLOSE ONE TIME ACTION CONTAINER
$(document).on("click", ".oneTimeActionContainerClose", function() {
  $(".oneTimeActionContainer").css({
    width: "0",
    opacity: "0",     
    "z-index": "0"    
  });      
});
    
function generateLetter(x, y, name, status) {
  $b.drawRect({
    type: "rectangle",
    fillStyle: "gray",
    x: x,
    y: y,
    width: 20,
    height: 20,
    shadowX: 2,
    shadowY: 3,
    shadowBlur: 2,
    shadowColor: "rgba(0,0,0,0.8)",
	status: status,
    name: name,
    layer: true,
    click: function(layer) {
      console.log(name);
    }  
  });
}

function generateReward(x, y, name, status) {
  $b.drawRect({
    type: "rectangle",
    strokeStyle: "lightgray",
    strokeWidth: 2,
    x: x,
    y: y,
    width: 20,
    height: 20,
    shadowX: 1,
    shadowY: 1,
    shadowBlur: 2,
    shadowColor: "rgba(0,0,0,0.8)",
	status,
    name: name,
    layer: true,
    click: function(layer) {
      console.log(name);
    }
  });
}

function generateEnemy(x, y, name, status) {
  $b.drawLine({
    strokeStyle: "green",
    strokeWidth: 2,
    closed: true,
    x1: x,
    y1: y,
    x2: x + 10,
    y2: y - 15,
    x3: x + 20,
    y3: y,
	status,
    name: name,
    layer: true,
    click: function(layer) {
      console.log(name);
      let nameNumber = name.slice(-1);
      arenaLoad(beginnerEnemyName[nameNumber]);
    }
  });
}

function generateTown(x, y, name, status) {
  // TOWN HABIT
  $b.drawRect({
    type: "rectangle",
    fillStyle: "lightgray",
	status: status,
    x: x,
    y: y,
    width: 20,
    height: 20,
    shadowX: 2,
    shadowY: 3,
    shadowBlur: 2,
    shadowColor: "rgba(0,0,0,0.8)",
    name: name,
    layer: true,
    click: function(layer) {
    // FIND TOWN
	
for (i=0;i<questBeginner.town.length;i++){
if(questBeginner.town[i].name == layer.name){
var townClickedId = questBeginner.town[i].id; 
}}

questBeginnerClick(townClickedId, "town");

	
    }
  });

  $b.drawLine({ 
    closed: true,
    fillStyle: "lightgray",
    x1: x - 10,
    y1: y - 10,
    x2: x,
    y2: y - 25,
    x3: x + 10,
    y3: y - 10,
    name: name,
    layer: true,
    click: function(layer) {
      console.log(name);
    },
    name: "roof" + name,
    layer: true
  });
}

/*
$("#questBeginnerCanvas").click(function(event) {
  alert(event.offsetX + ", " + event.offsetY);
});

*/



// QUEST BEGINNER FUNCTIONS!
function questBeginnerClick (questId, type) {



if (jQuery.inArray( questId, questBeginnerUnlocked) !== -1){

if(type === "town"){
$(".mainScreen").append('<div class="townContainer"></div>');
$(".townContainer").hide().fadeIn("slow");
// FIND TOWN
for (i=0;i<questBeginner.town.length;i++){
if(questBeginner.town[i].id === questId) {
var townClicked = questBeginner.town[i];
}}

$(".townContainer").html('<div class="townTitle">'+ townClicked.title +'</div><div class="townListContainer"><ul class="townList" id="'+ townClicked.id +'"></ul></div>');

if(townClicked.habit.length > 0) {
$(".townList").append('<li id="'+ townClicked.id +'habit" class="townHabit">'+ townClicked.habitTitle +'<br><ul class="townHabitText"></ul><div class="townTaskNumber"><span>1/5</span></div></li>');
};


if(townClicked.one.length > 0) {
$(".townList").append('<li id="'+ townClicked.id +'taskOne" class="townOneTimeTask">'+ townClicked.one +'<br><ul class="townTaskText"></ul><div class="townTaskNumber"><span>2/5</span></li>');
}
}

};

};


// Load individual quest  

$(document).on("click",".townList", function(event){

var townId = $(this).attr("id");

// FIND TOWN
for (i=0;i<questBeginner.town.length;i++){

if(questBeginner.town[i].id == townId){
var townClickedNumber = i; 
}}



// LOAD HABIT
if(event.target.id == townId + "habit"){

if($(".townHabit").hasClass("townQuestClicked")){
$(".townOneTimeTask, .townTaskNumber").fadeIn();  // add all the other tasks here
$(".townHabit").removeClass("townQuestClicked");
$(".townHabitText").children().remove();


} else {
$(".townOneTimeTask, .townTaskNumber").hide();  // add all the other tasks here
$(".townHabit").addClass("townQuestClicked");
$(".townHabitText").hide().fadeIn("slow", function(){
$(this).append('<li>' + questBeginner.town[townClickedNumber].habit + '<span class="townHabitAccept">Accept Habit</span></li>');
}); }

// LOAD TASK ONE
} else if (event.target.id = townId + "taskOne") {

if($(".townOneTimeTask").hasClass("townQuestClicked")){
$(".townHabit").fadeIn();  // add all the other tasks here
$(".townOneTimeTask").removeClass("townQuestClicked");
$(".townTaskText").children().remove();


} else {
$(".townHabit").hide();  // add all the other tasks here
$(".townOneTimeTask").addClass("townQuestClicked");
$(".townTaskText").hide().fadeIn("slow", function(){
$(this).append('<li><span>' + questBeginner.town[townClickedNumber].oneText + '</span><span class="townTaskVideo"><iframe src="'+ questBeginner.town[townClickedNumber].oneSource +'" frameborder="0" allowfullscreen></iframe></span> <span class="townTaskAccept">Accept Task</span></li>');
}); }




}





});





// ARENA FUNCTIONS HERE

function arenaLoad(enemyNumber) {
  currentOpponent = enemyNumber;
  loadCurrentOpponent();
  loadOpponentSkills();
  loadAvatarSkills();

  // MOVE AVATARS INTO ARENA
  $(".arenaOverlay").show();
  $(".avatarContainer").animate({
    left: "170px",
    top: "150px"
  });
  $(".opponentAvatarContainer").animate({
    right: "171px",
    top: "150px"
  });
}

$(document).on("click", ".arenaButton", function(){
  arenaLoad(0);
});


// LOADING OPPONENT
function loadCurrentOpponent() {
  opponentName = opponent[currentOpponent].name;
  opponentDescription = opponent[currentOpponent].description;
  opponentImage = opponent[currentOpponent].image;
  opponentHealth = opponent[currentOpponent].health;
  opponentMaxHealth = opponent[currentOpponent].maxHealth;
  opponentAttack = opponent[currentOpponent].attack;
  opponentDefense = opponent[currentOpponent].defense;
  opponentSkillPoints = parseInt(opponent[currentOpponent].skillPoints);
  
  
  // LOAD OPPONENT HEALTH 
  let opponentHealthPercentage = Math.floor(
    opponentHealth / opponentMaxHealth * 100
  );
  let opponentColorMinus = 255 - opponentHealthPercentage * 2;

  $(".opponentAvatarContainer").css({
    "background-image": "radial-gradient(ellipse farthest-corner at 50% 50%, rgba(" +
      opponentColorMinus +
      ", 0, 0, 0.2) 10%, rgba(0," +
      opponentHealthPercentage * 2.5 +
      ",0, 0.8) 90%)"
  });

  // PUTTING OPPONENT AVATAR IN THE MIDDLE
  $(".opponentAvatarContainer").append(
    '<img class="opponentAvatarImage" src="' + opponentImage + '">'
  );

  // ADDING SKILLPOINTS COUNTER
  $(".arenaSkillPointsCounter").html(skillPoints);
  $(".arenaOpponentSkillPointsCounter").html(opponentSkillPoints);
}

// LOAD AVATAR SKILLS!
function loadAvatarSkills() {
  for (i = 1; i < 6; i++) {
    $(".arenaStatContainer > span:nth-child(" + i + ")")
      .css("background", questColors[i - 1])
      .html("<span>" + avatar.stats[statName[i - 1]] + "</span>");
  }

  for (i = 0; i < skillsEquipped.length; i++) {
    $(".arenaAvatarSkillList").append(
      '<li><button class="arenaAvatarSkillButton" type="button" value="' +
        skills[skillsEquipped[i]].number +
        '">' +
        skills[skillsEquipped[i]].name +
        " (" +
        skills[skillsEquipped[i]].skillPoints +
        ")</button></li>"
    );
  }
}

// LOAD OPPONENT SKILLS 
function loadOpponentSkills() {
  for (i = 0; i < opponent[currentOpponent].skills.length; i++) {
    let opponentSkillsEquipped = opponent[currentOpponent].skills[i];

    $(".arenaOpponentSkillList").append(
      '<li><button class="arenaOpponentSkillButton" type="button" value="' +
        skills[opponentSkillsEquipped].number +
        '">' +
        skills[opponentSkillsEquipped].name +
        " (" +
        skills[opponentSkillsEquipped].skillPoints +
        ")</button></li>"
    );
  }
}

// UPDATE HEALTH FUNCTION!
function updateAvatarDamage() {
  opponentHealth -= damage;
  console.log(opponentHealth);
  skillPoints -= skillClicked.skillPoints;
  // CHECK IF FIGHT IS OVER
  if (opponentHealth <= 0) {
    console.log("You won this fight!");
    opponentHealth = opponentMaxHealth;
  } else if (opponentHealth > opponentMaxHealth) {
    opponentHealth = opponentMaxHealth;
  }

  // LOAD OPPONENT HEALTH BACKGROUND
  let opponentHealthPercentage = Math.floor(
    opponentHealth / opponentMaxHealth * 100
  );
  console.log(opponentHealthPercentage);
  let opponentColorMinus = 255 - Math.floor(opponentHealthPercentage * 2.5);

  $(".opponentAvatarContainer").css({
    "background-image": "radial-gradient(ellipse farthest-corner at 50% 50%, rgba(" +
      opponentColorMinus +
      ", 0, 0, 0.2) 10%, rgba(0," +
      opponentHealthPercentage * 2 +
      ",0, 0.8) 90%)"
  });

 
  
  $(".arenaSkillPointsCounter").html(skillPoints);
} // END ARENA UPDATE

function UpdateOpponentDamage () {
  health -= opponentSkillClicked.damage;

  console.log("Health: " + health);
   // AVATAR HEALTH BOUNDARIES - DYING AND MAXHEALTH

  if (health <= 0) {
    console.log("You just died!");
    health = maxHealth;
  }

  if (health > maxHealth) {
    console.log("max health!");
    health = maxHealth;
  }

  // LOADING HEALTH BACKGROUND
  healthPercentage = health / maxHealth * 100;

  let avatarColorMinus = 255 - Math.floor(healthPercentage * 2.5);

  $(".avatarContainer").css({
    "background-image": "radial-gradient(ellipse farthest-corner at 50% 50%, rgba(" +
      avatarColorMinus +
      ", 0, 0, 0.2) 10%, rgba(0," +
      healthPercentage * 2 +
      ",0, 0.8) 90%)"
  });
  
  $(".arenaOpponentSkillPointsCounter").html(opponentSkillPoints);
}



// SKILL POINT FUNCTIONS
function skillPointsIncrement() {
  if (skillPoints < skillPointsMax) {
    skillPoints++;
    $(".arenaSkillPointsCounter").html(skillPoints);
  }
}







// FIGHT!  
$(document).on("click", ".arenaAvatarSkillButton", function() {
  
  skillClicked = skills[$(this).attr("value")];
  // CHECK IF SKILLPOINTS ARE SUFFICIENT TO USE SKILL
  if (skillPoints >= skillClicked.skillPoints) {
    //animation coppled with button disable during animation
    $(this).css({
      animation: "skillCooldown " + skillClicked.cooldown + "s linear"
    });
    $(this).prop("disabled", true);
    $(this).on("animationend", function() {
      $(this).prop("disabled", false);
      this.removeAttribute("style");
    });

    // DAMAGE MODIFICATION THROUGH STATS
    let social = avatar.stats.social,
        knowledge = avatar.stats.knowledge,
        skills = avatar.stats.skills,
        statHealth = avatar.stats.health,
        experience = avatar.stats.experience;

	
	
    let arenaStatsRandom = statName[Math.floor(Math.random() * 5)];
	

    
	if (arenaStatsRandom === "social") {
        // SOCIAL PET ATTACKS!
        damage =
          skillClicked.damage * 0.4 +
          skillClicked.damage * 0.6 * (0.3 + Math.random() * 0.5) * social;
        
		
		// load attack animation with background-color
		attackAnimation("red");
		
		
		
		$(".arenaStatSocial").css({ 
          animation: "arenaStatColor 4s linear"
        });
        $(".arenaStatSocial").on("animationend", function() {
          $(".arenaStatSocial").css("animation", "");
        });
		
		
		
        } else if (arenaStatsRandom === "experience") {
        // EXPERIENCE - dodge next attack
		attackAnimation("orange");
        damage =
          skillClicked.damage * 0.4 +
          skillClicked.damage *
            0.6 *
            (0.5 + Math.random() * 0.5) *
            (1 + 0.2 * experience);
        $(".arenaStatExperience").css({
          animation: "arenaStatColor 4s linear"
        });
        $(".arenaStatExperience").on("animationend", function() {
          $(".arenaStatExperience").css("animation", "");
        });
		
		
        } else if (arenaStatsRandom === "knowledge") {
        // KNOWLEDGE RESTORE SOME SKILLPOINTS
		attackAnimation("blue");
        damage =
          skillClicked.damage * 0.4 +
          skillClicked.damage *
            0.6 *
            (0.5 + Math.random() * 0.5) *
            (1 + 0.2 * knowledge);
        $(".arenaStatKnowledge").css({
          animation: "arenaStatColor 4s linear"
        });
        $(".arenaStatKnowledge").on("animationend", function() {
          $(".arenaStatKnowledge").css("animation", "");
        });
		
		
        } else if (arenaStatsRandom === "skills") {
        // SKILLS LAND CRIT - amplifies damage for a few hits?
		attackAnimation("brown");
        damage =
          skillClicked.damage * 0.4 +
          skillClicked.damage *
            0.6 *
            (0.5 + Math.random() * 0.5) *
            (1 + 0.2 * skills);
        $(".arenaStatSkills").css({
          animation: "arenaStatColor 4s linear"
        });
        $(".arenaStatSkills").on("animationend", function() {
          $(".arenaStatSkills").css("animation", "");
        });
        } else if (arenaStatsRandom === "health") {
        // HEALTH - steal some life
		attackAnimation("green");
        damage =
          skillClicked.damage * 0.4 + skillClicked.damage * 0.6 * (0.5 + Math.random() * 0.5) * (1 + 0.2 * statHealth);
        $(".arenaStatHealth").css({
          animation: "arenaStatColor 4s linear"
        });
        $(".arenaStatHealth").on("animationend", function() {
          $(".arenaStatHealth").css("animation", "");
        });
    }
    
    health += skillClicked.heal;

    updateAvatarDamage();
  }
});

// IT FIGHTS BACK! Maybe.
$(document).on("click", ".arenaOpponentSkillButton", function() {
  opponentSkillClicked = skills[$(this).attr("value")];
  let opponentSkillCooldown = opponentSkillClicked.cooldown;
  
  
  // put into avatar attack? so you can start the fight, whenever you want to and dont get into panic
  setInterval(function(){
  $(".arenaOpponentSkillButton").trigger('click');
}, opponentSkillCooldown);

  //animation coppled with button disable during animation
  $(this).css({
    animation: "skillCooldown " + opponentSkillCooldown + "s linear"
  });
  $(this).prop("disabled", true);
  $(this).on("animationend", function() {
    $(this).prop("disabled", false);
    this.removeAttribute("style");
  });

  updateOpponentDamage();
});

// Arena Console!

$(document).on("click", ".arenaConsoleLoadOpponent", function() {
  currentOpponent = $(".arenaConsoleSelectOpponent")
    .find(":selected")
    .attr("value");
  $(".opponentAvatarContainer").empty();
  $(".arenaOpponentSkillList").children().remove();
  loadCurrentOpponent();
});

$(document).on("click", ".arenaConsoleButton", function() {
  if ($(this).text() == "Avatar Health +") {
    health += 5;
    updateOpponentDamage();
  } else if ($(this).text() == "Avatar Health -") {
    health -= 5;
    updateOpponentDamage();
  } else if ($(this).text() == "Opponent Health +") {
    opponentHealth += 5;
    updateAvatarDamage();
  } else if ($(this).text() == "Opponent Health -") {
    opponentHealth -= 5;
    updateAvatarDamage();
  }
});

// ADD SKILLPOINTS
$(document).on("click", ".skillPointsPlusSubmit", function() {
  let skillPointsPlus = parseInt($(".skillPointsPlus").val());
  skillPoints += skillPointsPlus;
  updateArena();
});

// ADD SKILLPOINTS OPPONENT
$(document).on("click", ".skillPointsPlusSubmitOpponent", function() {
  let skillPointsPlus = parseInt($(".skillPointsPlus").val());

  opponentSkillPoints += skillPointsPlus;
  updateArena();
});





// ARENA CANVAS ANIMATION

function attackAnimation(color){
 

 
 // Animation background
$a.drawRect({
  fillStyle: color,
  width: 100,
    height: 100,
	opacity: 0.25,
 x: 40, y: 70,
 layer: true,
 name: "animationBackground"
});
 

 // Load Weapon
 $a.drawImage({
  source: avatar.equipped.weapon.source,
  x: 40, y: 70,
  layer: true, 
  name: "swordAnimation"
});


 $a.animateLayer('swordAnimation', {
  x: 100,
  rotate: 80
}, 500, function(layer) {
   
  // Callback function
  $(this).animateLayer(layer, {
    x: 100,
    rotate: 80
  }, 'fast', 'swing').removeLayers();
});

 $a.animateLayer('animationBackground', {
  x: 100,
  rotate: 80
}, 500, function(layer) {
  // Callback function
  $(this).animateLayer(layer, {
    x: 100,
    rotate: 80
  }, 'fast', 'swing').removeLayers();
});


// Load damage image on top of opponent container Problemkind
$oa.drawText({
  fillStyle: '#9cf',
  strokeStyle: 'rgba(255, 255, 255, 0.5)',
  strokeWidth: 2,
  x: 20, y: 70,
  fontSize: 32,
  fontFamily: 'Verdana, sans-serif',
  text: Math.floor(damage),
})



}







// EXPERIENCE FUNCTION

// +EXP
$(".experienceOnePlus").click(function() {
  experienceOne += 7;
  update();
});

$(".experienceTwoPlus").click(function() {
  experienceTwo += 7;
  update();
});

// HEALTH FUNCTIONS

$(".healthMinus").click(function() {
  health -= 3;
  update();
});

$(".healthPlus").click(function() {
  health += 7;
  update();
});

// GOLD FUNCTIONS

// + GOLD
$(".goldPlus").click(function() {
  gold += 1;
  console.log("Gold: " + gold);
  update();
});

// - GOLD
$(".goldMinus").click(function() {
  gold -= 1;

  if (gold < 0) {
    gold = 0;
    console.log("You have no gold!");
  }

  update();
  console.log("Gold: " + gold);
});

// SIDEBAR NAVIGATION

$(document).on("click", ".questGlobalButton", function() {
  $(".questGlobalButton").replaceWith(
    '<p class="interfaceButton">Interface</p>'
  );
  
  $(".interface").fadeOut("slow", function(){ 
   $("#questBeginnerCanvas").fadeIn("slow");
  
  });
 
});

$(document).on("click", ".interfaceButton", function() {
  $(".interfaceButton").replaceWith('<p class="questGlobalButton">Quests</p>');
  $("#questBeginnerCanvas").fadeOut("slow", function(){
    $(".interface").fadeIn("slow");
  });

});



// MARKET FUNCTIONS

$(".marketImageContainer").click(function() {
  if (buyApproval === false) {
    $(".buyApproval").width("25px").css("border", "1px solid black");
    $(".buyButtonYes").fadeIn("slow");
    $(".buyButtonNo").fadeIn("slow");
    buyApproval = true;
  } else if (buyApproval === true) {
    $(".buyApproval").css("width", "0px").css("border", "0");
    $(".buyButtonYes").hide();
    $(".buyButtonNo").hide();
    buyApproval = false;
  }
});

// APPEND ITEM IMAGE TO LIST,  
$(".buyButtonYes").click(function() {
  if (gold >= itemPlayGround[buyOrder[itemOfInterest]].gold) {
    itemsOwned.equipment.push(itemPlayGround[buyOrder[itemOfInterest]].number);
    $(".shopItemList").append(
      "<img src='" +
        itemPlayGround[buyOrder[itemOfInterest]].source +
        "'" +
        "class='shopItemListImage' alt='" +
        itemPlayGround[buyOrder[itemOfInterest]].name +
        "' value='" +
        itemPlayGround[buyOrder[itemOfInterest]].category +
        "'>"
    );

    gold -= itemPlayGround[buyOrder[itemOfInterest]].gold;
    itemOfInterest++;
	sortItems();
    update();
    $(".buyApproval").css("width", "0px").css("border", "0");
    $(".buyButtonYes").hide();
    $(".buyButtonNo").hide();
    buyApproval = false;
  }
});

$(".buyButtonNo").click(function() {
  $(".buyApproval").css("width", "0px").css("border", "0");
  $(".buyButtonYes").hide();
  $(".buyButtonNo").hide();
  buyApproval = false;
});



// ITEM PLAYGROUND HERE

function addItem(position) {
  // use with drop function itemsOwned.equipment.push(itemPlayGround[position].number);
  $(".shopItemList").append(
    "<img src='" +
      itemPlayGround[position].source +
      "'" +
      "class='shopItemListImage' alt='" +
      itemPlayGround[position].name +
      "' value='" +
      itemPlayGround[position].category +
      "'>"
  );
  
  // show them as itemEquipped (maybe try to simplify)
  if(itemPlayGround[position].name == avatar.equipped.weapon.name) {
  $('img[alt="' + itemPlayGround[position].name + '"').addClass("itemEquipped");
  } else if (itemPlayGround[position].name == avatar.equipped.shield.name){
  $('img[alt="' + itemPlayGround[position].name + '"').addClass("itemEquipped");
  } else if (itemPlayGround[position].name == avatar.equipped.armor.name){
  $('img[alt="' + itemPlayGround[position].name + '"').addClass("itemEquipped");
  } else if (itemPlayGround[position].name == avatar.equipped.shoes.name){
  $('img[alt="' + itemPlayGround[position].name + '"').addClass("itemEquipped");
  } else if (itemPlayGround[position].name == avatar.equipped.helmet.name){
  $('img[alt="' + itemPlayGround[position].name + '"').addClass("itemEquipped");
  } 
  
}

function sortItems() {
let categoryPosition = ["armor","helmet","weapon","shield","shoes"];
$(".shopItemList > img").sort(shopItemListSort) // sort elements
                  .appendTo('.shopItemList'); // append again to the list
				  
// sort function callback, sorts according to category! 
function shopItemListSort(a, b){
    return (categoryPosition.indexOf($(b).attr('value'))< categoryPosition.indexOf($(a).attr('value'))) ? 1 : -1;    
}

}


  // ADD BACKGROUND
  function addBackground(position) {
  // itemsOwned.backgrounds.push(avatarBackground[position].number);
  $(".shopBackgroundList").append(
    "<img src='" +
      avatarBackground[position].source +
      "'" +
      "class='shopBackgroundImage' alt='" +
      avatarBackground[position].name +
      "' value='" +
      avatarBackground[position].category +
      "'>"
  );
}




// EQUIP AVATAR BACKGROUND
$(document).on("click", ".shopBackgroundImage", function() {
  
  
  if($(this).hasClass("itemEquipped") !== true) {
  $(this).parent().children().removeClass("itemEquipped");
  $(this).addClass("itemEquipped");
  //FIND VARIABLE NAME
  let backgroundClicked = $(this).attr("alt");
  // SEARCH FOR ITEM IN ARYA
  for (i = 0; i < avatarBackground.length; i++) {
    // DOES ITEMNAME MATCH ARYA ITEM?
    if (backgroundClicked == avatarBackground[i].name) {
      backgroundClicked = avatarBackground[i];
    }
  }  
  
    $(".itemPreview").css(
      "background-image",
      "url(" + backgroundClicked.source + ")"
    ); 
 } else {
 $(this).removeClass("itemEquipped");
 
 }
 
 });
  
  
  
  
  
// SHOP FUNCTIONS hier2
var shopItemToBuyQuantity = 3,
    shopItemToBuyList = [12,13,14];


function loadItemsToBuy () {
if(!$(".shopItemBuyListContainer")[0]){
$(".shopContainer").append('<div class="shopItemBuyListContainer"><ul class="shopItemBuyList"></ul></div>');
for(i=0;i<shopItemToBuyQuantity;i++){
$(".shopItemBuyList").append('<li><img class="shopItemListImage shopItemBuyListImage" alt ="buy_'+ itemPlayGround[shopItemToBuyList[i]].name +'" src="'+ itemPlayGround[shopItemToBuyList[i]].source +'"/><span class="shopItemBuyListImagePrice">Gold: '+ itemPlayGround[shopItemToBuyList[i]].gold +'</span></li>');
}
}


}

$(document).on("click",".shopItemBuyListImage", function(){
let itemClicked = $(this).prop("src");
for(i=0;i<itemPlayGround.length;i++){
if(itemPlayGround[i].source == itemClicked){
itemClicked = itemPlayGround[i];
}
}
// Two options, buy and preview
$(this).parent().append('<div class="shopItemBuyQuestionContainer"><span class="shopItemBuyQuestionPreviewButton">Preview </span><br><span class="shopItemBuyQuestionBuyButton">Buy</span></div>');
//Preview Item, Load item for 5 seconds, don't equip it
$(".shopItemBuyQuestionPreviewButton").click(function(){
//remove equipped item
$('.itemPreview img[alt="' + avatar.equipped[category].name + '"').remove();
//equip new item without equipping it to avatar
$(".itemPreview").append(
      "<img src='" +
       itemClicked.source +
        "' alt='" + itemClicked.name + 
        "' style=' width:" + itemClicked.size[0] + "px; height:" + itemClicked.size[1] +  
        "px; position:absolute;top:" + (itemClicked.coordinates[0] + 30) + "px;left:" + (itemClicked.coordinates[1] + 30) + "px; z-index:"+ itemClicked.layer + "'>");

});

// Buy Item, equip it
$(".shopItemBuyQuestionBuyButton").click(function(){
if(gold>=itemClicked.gold){
addItem(itemClicked.number);
equipArmor("itemPreview", itemClicked.number, 0, 0);
} else { alert("You do not have sufficient gold"); };
});
});












$(document).on("click",".shopPetsButton", function() {

$(".shopListContainer").children().hide();
$(".shopPetList, .shopPetFood").show();

});

$(document).on("click",".shopEquipmentButton", function() {
sortItems();
$(".shopListContainer").children().hide();
$(".shopItemList").show();

});

$(document).on("click",".shopBackgroundButton", function() {

$(".shopListContainer").children().hide();
$(".shopBackgroundList").show();

});


$(document).on("click",".shopUsablesButton", function() {

$(".shopListContainer").children().hide();
$(".shopUsablesList").show();

});


function equipArmor (position, numberOfItem, x, y) {
  // define category
  let category = itemPlayGround[numberOfItem].category;

if (itemPlayGround[numberOfItem].length !== 0) {
//remove equipped item
$('.itemPreview img[alt="' + avatar.equipped[category].name + '"').remove();
//append new item 
 $("." + position).append(
      "<img src='" +
       itemPlayGround[numberOfItem].source +
        "' alt='" + itemPlayGround[numberOfItem].name + 
        "' value='" +
        itemPlayGround[numberOfItem].category + "Equipped" +  "' style=' width:" + itemPlayGround[numberOfItem].size[0] + "px; height:" + itemPlayGround[numberOfItem].size[1] +  
        "px; position:absolute;top:" + (itemPlayGround[numberOfItem].coordinates[0] + y) + "px;left:" + (itemPlayGround[numberOfItem].coordinates[1] + x) + "px; z-index:"+ itemPlayGround[numberOfItem].layer + "'>");

  
  // PUSH ONTO AVATAR EQUIPPED
  if(category == "weapon"){
  $.extend(true, avatar.equipped, {
  weapon: itemPlayGround[numberOfItem]
});

} 
						
  else if (category == "armor") {
  $.extend(true, avatar.equipped, {
  armor: itemPlayGround[numberOfItem]
});}
               
  else if (category == "shoes") {
  $.extend(true, avatar.equipped, {
  shoes: itemPlayGround[numberOfItem]
});}
  
  else if (category == "helmet") {
  $.extend(true, avatar.equipped, {
  helmet: itemPlayGround[numberOfItem]
});}
               
  else if (category == "shield") {
  $.extend(true, avatar.equipped, {
  shield: itemPlayGround[numberOfItem]
});} 
  
  $('img[alt="' + avatar.equipped[category].name + '"').addClass("itemEquipped");
  updateAvatarEquipped();
} // end if 

}








function updateAvatarEquipped () {
  $(".leftHandEquipped").html("left hand: " + avatar.equipped.weapon.name);
  $(".rightHandEquipped").html("right hand: " + avatar.equipped.shield.name);
  $(".helmetEquipped").html("helmet: " + avatar.equipped.helmet.name);
  $(".armorEquipped").html("armor: " + avatar.equipped.armor.name);
  $(".shoesEquipped").html("shoes: " + avatar.equipped.shoes.name);
  
}




// HOVER FUNCTIONS SPEECH AND THOUGHTBUBBLE


// AVATAR THOUGHTBUBBLE 

function avatarThoughtBubble (thoughtSource, thoughtText, time) {

if (avatarLocation == "sideBar") {
$(".avatarContainer").append('<div class="avatarThoughtBubbleContainer"><img class="avatarThoughtBubble" src="http://res.cloudinary.com/gionisos/image/upload/v1498408619/Speech-Bubble-PNG-Pic_x5qzjw.png"><span class="avatarThoughtText"></span></div>');

if(petEquipped !== "") {
if(thoughtSource !== ""){
$(".avatarThoughtBubbleContainer").append('<img class="avatarThought" src="'+ thoughtSource +'">');
}
if(thoughtText !== "") {
$(".avatarThoughtText").html(thoughtText);
}
} else {
if(thoughtSource !== ""){
$(".avatarThoughtBubbleContainer").append('<img class="avatarThought" src="'+ thoughtSource +'">').css("left", "145px");
}
if(thoughtText !== "") {
$(".avatarThoughtText").html(thoughtText);
$(".avatarThoughtBubbleContainer").css("left", "145px");
}



}

setTimeout(closeThoughtBubble, 4000);

}
}

//Remove thoughtbubble

function closeThoughtBubble() {
$(".avatarThoughtBubbleContainer").fadeOut("slow", function(){$(this).remove();});
}


$(document).on("click", ".avatarThoughtBubble, .avatarThought, .avatarThoughtText", function(){
closeThoughtBubble();
});

 var shopSpeechBubbleTimeOut;
// SPEECHBUBBLE HOVER SHOP ITEM 
$(".shopItemListImage").hover(function() {
	let temporaryThis = $(this);
     if (!shopSpeechBubbleTimeOut) {
      shopSpeechBubbleTimeOut = window.setTimeout(function() {
      shopSpeechBubbleTimeOut = null; 
    let itemHover = temporaryThis.attr("alt");
    // SEARCH FOR ITEM IN ARYA
    for (i = 0; i < itemPlayGround.length; i++) {
    // DOES ITEMNAME MATCH ARYA ITEM?
    if (itemHover == itemPlayGround[i].name) {
      itemHover = itemPlayGround[i];
    }
  }
  if (itemHover.descriptionShop !== undefined){
  if(petEquipped !== "") { 
  $(".itemPreview").append('<div class="shopSpeechBubbleContainer"><img class="shopSpeechBubble" src="http://res.cloudinary.com/gionisos/image/upload/v1498586823/Speech-Bubble-PNG-Picture_sa8jrn_jwfngd.png"/><span class="shopSpeech">'+ itemHover.descriptionShop +'</span></div>');
  $(".shopSpeechBubbleContainer").hide().fadeIn("slow");
  } else {
  $(".itemPreview").append('<div class="shopSpeechBubbleContainer"><img class="shopSpeechBubble" src="http://res.cloudinary.com/gionisos/image/upload/v1498586823/Speech-Bubble-PNG-Picture_sa8jrn_jwfngd.png"/><span class="shopSpeech">'+ itemHover.descriptionShop +'</span></div>');
  $(".shopSpeechBubbleContainer").hide().fadeIn("slow").css("left", "140px");
  }
  }
           }, 500);
        }
    },
    function () {
        if (shopSpeechBubbleTimeOut) {
            window.clearTimeout(shopSpeechBubbleTimeOut);
            shopSpeechBubbleTimeOut = null;
        }
        else {
		$(".shopSpeechBubbleContainer").fadeOut("slow", function(){ $(this).remove(); });
        }
    });

// SPEECHBUBBLE SIDEBAR HOVER ITEM OF INTEREST
    var sideBarThoughtBubbleTimeOut;
    $(".marketImageContainer").hover(function() {
	let temporaryThis = $(this).find(">:first-child");
     if (!sideBarThoughtBubbleTimeOut) {
      sideBarThoughtBubbleTimeOut = window.setTimeout(function() {
      sideBarThoughtBubbleTimeOut = null; 
    let itemHover = temporaryThis.attr("alt");
    // SEARCH FOR ITEM IN ARYA
    for (i = 0; i < itemPlayGround.length; i++) {
    // DOES ITEMNAME MATCH ARYA ITEM?
    if (itemHover == itemPlayGround[i].name) {
      itemHover = itemPlayGround[i];
    }
  }
  if (itemHover.descriptionSideBar !== undefined){
  avatarThoughtBubble("", itemHover.descriptionSideBar);
  }
           }, 800);
        }
    },
    function () {
        if (sideBarThoughtBubbleTimeOut) {
            window.clearTimeout(sideBarThoughtBubbleTimeOut);
            sideBarThoughtBubbleTimeOut = null;
        }
        else {
	    $(".avatarThoughtBubbleContainer").fadeOut("slow", function(){$(this).remove();});
        }
    });







// EQUIPPING ITEMS, itemEquip here


$(document).on("click", ".shopItemListImage", function() {
  
  
  //FIND VARIABLE NAME
  let itemClicked = $(this).attr("alt");
  // SEARCH FOR ITEM IN ARYA
  for (i = 0; i < itemPlayGround.length; i++) {
    // DOES ITEMNAME MATCH ARYA ITEM?
    if (itemClicked == itemPlayGround[i].name) {
      itemClicked = itemPlayGround[i];
    }
  }
  
  if (itemClicked.category == "background") {
    $(".itemPreview").css(
      "background-image",
      "url(" + itemClicked.source + ")"
    ); 
   } 
  
  let category = itemClicked.category;
  let avatarCategory = avatar.equipped[category];
  let nameOfItem = avatarCategory.name;
  
  if(avatarCategory === "") {
  
  if(petEquipped === "") {
  equipArmor("itemPreview", itemClicked.number, -30,0);
  } else {
  // avatar has no item in that category
  equipArmor("itemPreview", itemClicked.number, 0,0);
  }
  } 
  
  
  else if (itemClicked.name == avatar.equipped[category].name) {
    // avatar has same item in this category, unequip
    $(this).removeClass("itemEquipped");
    $('.itemPreview > img[alt="' + avatar.equipped[category].name + '"').remove();
 
     // REMOVE FROM AVATAR EQUIPPED
  if(category == "weapon"){
  $.extend(true, avatar.equipped, {
  weapon: ""
});} 
                    
  else if (category == "armor") {
  $.extend(true, avatar.equipped, {
  armor: ""
});}
               
  else if (category == "shoes") {
  $.extend(true, avatar.equipped, {
  shoes: ""
});}
               
  else if (category == "helmet") {
  $.extend(true, avatar.equipped, {
  helmet: ""
});}
               
  else if (category == "shield") {
  $.extend(true, avatar.equipped, {
  shield: ""
  
  
});}  
  // ELSE IF ANOTHER ITEM OF THE SAME CATEGORY IS EQUIPPED
  } else if (avatar.equipped[category].name !== "") {
    // REMOVE ITEM EQUIPPED 
    $('.itemPreview > img[alt="' + avatar.equipped[category].name + '"').remove();
   $('img[alt="' + avatar.equipped[category].name + '"').removeClass("itemEquipped");
    
    // ADD NEW ITEM in right position
	if(petEquipped === "") {
  equipArmor("itemPreview", itemClicked.number, -30,0);
  } else {
  equipArmor("itemPreview", itemClicked.number, 0,0);
  }
  }
   

  updateAvatarEquipped();    
});



// LOAD AVATAR INTO RIGHT POSITION 
function avatarImageLoad(avatarPosition) {
let itemCategory = ["armor","shield","weapon","helmet","shoes"];


if (avatarPosition === "sideBar") {

avatarLocation = "sideBar";
// REMOVE OTHER VERSIONS OF YOU!
$(".itemPreview").children().remove();

// AvatarImageFloatingIsland 
$(".avatarContainer").append('<div class="avatarContainerBackgroundDiv"><img class="avatarContainerBackground" src="http://res.cloudinary.com/gionisos/image/upload/v1497889280/avatarImageBackground_fye7om_a3z0mi.png"></img></div>');
$(".avatarContainerBackgroundDiv").hide().fadeIn(800);
$(".avatarContainer").append('<img class="avatarImage" src="http://res.cloudinary.com/gionisos/image/upload/v1497443267/avatarWithoutBackground_oal8a6.png"></img>'); 


if (petEquipped !== ""){
$(".avatarContainer").append('<img class="sideBarPet" style="width:'+ pet[petEquipped].size[0] +'px; height:'+ pet[petEquipped].size[1]+'px" src="'+ pet[petEquipped].source +'"></img>');

for (i=0; i<4;i++){

 if (avatar.equipped[itemCategory[i]].length !== 0) {
 $(".avatarContainer").append(
      "<img src='" +
        avatar.equipped[itemCategory[i]].source +
        "' alt='" + avatar.equipped[itemCategory[i]].name + 
        "' value='" +
        itemCategory[i] + "Equipped" +  "' style=' width:" + avatar.equipped[itemCategory[i]].size[0] + "px; height:" + avatar.equipped[itemCategory[i]].size[1] +  
        "px; position:absolute;top:" + (avatar.equipped[itemCategory[i]].coordinates[0] - 53) + "px;left:" + (avatar.equipped[itemCategory[i]].coordinates[1] -11) + "px; z-index:"+ avatar.equipped[itemCategory[i]].layer + "'>");
}
} // end for loop

} else {

for (i=0; i<4;i++){

// shift avatar into middle
$(".avatarImage").css({
"top":"3px",
"left":"60px",
});

 if (avatar.equipped[itemCategory[i]].length !== 0) {
 $(".avatarContainer").append(
      "<img src='" +
        avatar.equipped[itemCategory[i]].source +
        "' alt='" + avatar.equipped[itemCategory[i]].name + 
        "' value='" +
        itemCategory[i] + "Equipped" +  "' style=' width:" + avatar.equipped[itemCategory[i]].size[0] + "px; height:" + avatar.equipped[itemCategory[i]].size[1] +  
        "px; position:absolute;top:" + (avatar.equipped[itemCategory[i]].coordinates[0]-45) + "px;left:" + (avatar.equipped[itemCategory[i]].coordinates[1]-22) + "px; z-index:"+ avatar.equipped[itemCategory[i]].layer + "'>");
}
} // end for loop
}

$(".avatarContainer > img").hide().fadeIn(800);



} else if (avatarPosition === "shop") {


avatarLocation = "shop"; 

$(".avatarContainer").children().remove();




//there is a pet, load avatar into right position
if (petEquipped !== ""){
$(".itemPreview").children().remove();
$(".itemPreview").append('<img class="avatarShop" src="http://res.cloudinary.com/gionisos/image/upload/v1497443267/avatarWithoutBackground_oal8a6.png"></img><img class="shopPet" alt ="shopPet" style="width:'+ pet[petEquipped].size[0] +'px; height:'+ pet[petEquipped].size[1]+'px" src="'+ pet[petEquipped].source +'"></img>');
$(".avatarShop").css({
"left":"130px",
});


for (i=0; i<4;i++){
 if (avatar.equipped[itemCategory[i]].length !== 0) {
 $(".itemPreview").append(
      "<img src='" +
        avatar.equipped[itemCategory[i]].source +
        "' alt='" +
        avatar.equipped[itemCategory[i]].name + 
        "' value='" + itemCategory[i] + "Equipped" +  "' style=' width:" + avatar.equipped[itemCategory[i]].size[0] + "px; height:" + avatar.equipped[itemCategory[i]].size[1] +  
        "px; position:absolute;top:" + avatar.equipped[itemCategory[i]].coordinates[0] + "px;left:" + avatar.equipped[itemCategory[i]].coordinates[1] + "px; z-index:"+ avatar.equipped[itemCategory[i]].layer + "'>");

}
}
} else {
// pet is currently unequipped
$(".itemPreview").children().remove();
$(".itemPreview").append('<img class="avatarShop" src="http://res.cloudinary.com/gionisos/image/upload/v1497443267/avatarWithoutBackground_oal8a6.png"></img>');
$(".avatarShop").css({
"left":"100px",
});

for (i=0; i<4;i++){
 if (avatar.equipped[itemCategory[i]].length !== 0) {
 $(".itemPreview").append(
      "<img src='" +
        avatar.equipped[itemCategory[i]].source +
        "' alt='" +
        avatar.equipped[itemCategory[i]].name + 
        "' value='" + itemCategory[i] + "Equipped" +  "' style=' width:" + avatar.equipped[itemCategory[i]].size[0] + "px; height:" + avatar.equipped[itemCategory[i]].size[1] +  
        "px; position:absolute;top:" + avatar.equipped[itemCategory[i]].coordinates[0] + "px;left:" + (avatar.equipped[itemCategory[i]].coordinates[1]-30) + "px; z-index:"+ avatar.equipped[itemCategory[i]].layer + "'>");

}
}
} // end pet if else statement

$(".itemPreview > img").hide().fadeIn(800);
}
}

avatarImageLoad("sideBar");





// avatar animation

$(document).on("click",".itemPreview > img", function(){

alert("You just touched me! At least go and wash your hands beforehand!");

});



















// INTERFACE FUNCTIONS!


// DAILY LIST daily here

$(".dailyList").sortable({
  axis: "y",
  containment: ".interfaceQuadrant",
  cursor: "move",
});
// ADD DAILY
$(document).on("click", ".dailyListAddContainer", function(){
  $(this).hide();
  
  //
  $(".dailyList").append('<li class="dailyListItemTemporary"><input type="text" class="dailyListAddTitle"></input></li>');
  $(".dailyListAddTitle").focus();
});

$(document).on("keypress", ".dailyListAddTitle", function(input) {
  let dailyTitle = $(".dailyListAddTitle").val();
 
  if (input.keyCode == 13 && dailyTitle.length >= 3) {
    
    // Save for reloading;
    dailySave.push({
      status: "active",
      id: dailyId,
      title: dailyTitle,
	  description: "",
	  checked: false,
      gold: 5,
      experience: 5,
      progress: 0, //number of times you already succeeded
    });
    
    // Remove temporary list and replace it with new daily
    $(".dailyListItemTemporary").remove();
    
    dailyListUpdate();
    
    // Add individual id to each daily
    dailyId++;
    
   // Make daily add function available again if you don't exceed the max dailies
   dailyCurrent++;
    
   if(dailyCurrent >= dailyMax) {
    dailyCurrent = dailyMax;
    $(".dailyListAddContainer").hide();
   } else {
    $(".dailyListAddContainer").show(); }
  }});

// IF MOUSE MOVES OUT OF CONTAINER REMOVE ADD CONTAINER  
if(".dailyListItemTemporary".length > 0) {
$(document).on("mouseleave", ".interfaceQuadrant", function(){
 $(".dailyListItemTemporary").remove();
 if(dailyCurrent < dailyMax) {
 $(".dailyListAddContainer").show();
 }
});
}  

// IF DAILY CURRENT = 0 show add Container
if (dailyCurrent === 0) {
$(".dailyListAddContainer, .dailyListAdd").css("opacity", "0.6");
} 
  
function dailyListUpdate(reload) {
  // RELOAD LIST COMPLETELY! 
  if(reload) {
  //remove all items that there possibly are
  $(".dailyList").children().remove();
  //reload list
  for (i=0;i<dailySave.length;i++){
   if(dailySave[i].status == "active" && dailySave[i].progress <= 30){
   $(".dailyList").append('<li class="dailyListItem" id="dailyListItem' + dailySave[i].id + '"><span class="dailyListItemTitle">' + dailySave[i].title  + '</span><span class="dailyListItemDone"></span></li>');
	let progressPercentage = Math.floor(dailySave[i].progress / 30 * 100);
   $("#dailyListItem" + dailySave[i].id).css({"background":"linear-gradient(to left, #F0FFF0 0%, #CD7F32 "+ progressPercentage +"%"}).css({"border": "1px solid " + questColors[statName.indexOf(dailySave[i].category)]});
   
	}
  if(dailySave[i].checked) {
  $("#dailyListItem" + dailySave[i].id).find(".dailyListItemDone").append('<i class="fa fa-check dailyChecked"></i>').parent().css("opacity", "0.3");
  }
	} 
	
   if (dailyCurrent > 0) {
   $(".dailyListAddContainer, .dailyListAdd").css("opacity", "0"); //make addContainer only visible on hover again
   }

  } else {
    
   // RELOAD LAST ADDED ITEM! 
   $(".dailyList").append('<li class="dailyListItem" id="dailyListItem' + dailySave[dailySave.length -1].id + '">' + dailySave[dailySave.length - 1].title  + '<span class="dailyListItemDone"></span></li>');
   $(".dailyListAddContainer, .dailyListAdd").css("opacity", "0");


  
  }
  if (dailySave[dailySave.length -1].progress <= 30) {
    let progressPercentage = Math.floor(dailySave[dailySave.length -1].progress / 30 * 100);
   
  $("#dailyListItem" + dailySave[dailySave.length -1].id).css({
   "background":"linear-gradient(to left, #F0FFF0 0%, #CD7F32 "+ progressPercentage +"%"});
    
    
    
} else if (dailySave[dailySave.length -1].progress > 30 && dailySave[dailySave.length -1].progress <= 50) {
  // ENTER COLORS FOR HIGHER PROGRESS HERE 
} else if (dailySave[dailySave.length -1].progress > 50 && dailySave[dailySave.length -1].progress <= 75) {
  // ENTER COLORS FOR HIGHER PROGRESS HERE 
}
}


// DAILY DONE
$(document).on("click", ".dailyListItemDone", function(){
 let dailyClicked = $(this).parent().prop("id");
 
 
  if($(this).children().hasClass("dailyChecked")){  
  // REMOVE DAILY CHECKED!
  $(this).parent().css("opacity", "1");
  $(this).children(".dailyChecked").remove();
 
 for (i=0; i<dailySave.length;i++){
   if(dailyClicked == "dailyListItem" + dailySave[i].id){
   
   let difficulty = 1;
   if(dailySave[i].difficulty == "easy"){
   difficulty = 0.5;
   } else if (dailySave[i].difficulty == "hard") {
   difficulty = 1.5;
   }
   
     gold -= dailySave[i].gold * difficulty;
     experienceOne -= dailySave[i].experience * difficulty;
     dailySave[i].progress -= 1;
     health -= 2 + ((maxHealth - health) / 10) * difficulty; // replenish base value + 10% of missing health
     $.extend(true, dailySave[i], {checked: false});
	 dailiesCheckedToday--;
	}}
  
} else {
  // ADD DAILY CHECKED
 $(this).append('<i class="fa fa-check dailyChecked"></i>'); 
 $(this).parent().css("opacity", "0.3");
 // Allow for random drops to happen
  randomDrop("low");
  
 for (i=0; i<dailySave.length;i++){
   if(dailyClicked == "dailyListItem" + dailySave[i].id){
   
   let difficulty = 1;
   if(dailySave[i].difficulty == "easy"){
   difficulty = 0.5;
   } else if (dailySave[i].difficulty == "hard") {
   difficulty = 1.5;
   }
     gold += dailySave[i].gold * difficulty;
     experienceOne += dailySave[i].experience * difficulty;
     dailySave[i].progress += 1;
     health += 2 + ((maxHealth - health) / 10) * difficulty; // replenish base value + 10% of missing health
     $.extend(true, dailySave[i], {checked: true});
	 
     // SPREE MECHANISM
     dailiesCheckedToday++;
     
     if (dailiesCheckedToday >= dailyCurrent){
     dailiesCheckedToday = -10; // arbitrary number, don't get spree again - set to 0 on day start 
     spree++;
     $(".spreeText").show();
     $(".spreeNumber").text(spree);
     }

   }}
}

     update();
});

	


// DAILY HOVER FUNCTION 

$(document).on("mouseover", ".dailyListItem", function() {
if(!$(".dailyListItemEdit")[0]) {
let dailyHovered = $(this).prop("id"),
// only works until 10! could do with if substring -2 > 9 till 99
   dailyHoveredId = dailyHovered.substr(dailyHovered.length - 1);
   
var dailyThis = $(this),
	dailyHoveredCurrentTemporary = "";
    
   
for(i=0;i<dailySave.length;i++){
 if(dailySave[i].id == dailyHoveredId) {
    dailySaveCurrentTemporary = dailySave[i];
 }
 }

if(dailySaveCurrentTemporary.description.length > 0) {

dailyHoverTimer = setTimeout(function(){
//change to a more specific one 
 if ($("#" + dailyHovered).is(':hover') && !$(".dailyListItemEdit")[0]) {
$("#" + dailyHovered).append('<div class="dailyListItemHoverContainer"><div class="descriptionArrowUp"><div class="descriptionArrowUpInside"></div></div><span>'+ dailySaveCurrentTemporary.description +'</span></div>');
 }}, 1800);
 
} 
}

});

function closeDailyHover () {
clearTimeout(dailyHoverTimer);
$(".dailyListItemHoverContainer").remove();
}

// CLOSE HOVER IF YOU LEAVE ITEM
$(document).on("mouseleave", ".dailyListItem", function() {
closeDailyHover();
});

$(document).on("mouseleave", ".dailyListItem", function() {
closeDailyHover();
});

	
	

// DAILY RIGHT CLICK 
$(document).on("mousedown", ".dailyListItem", function(event) {
  if (event.which === 3 && $(".dailyListItemRight").length === 0) {
  
  let dailyRightClicked = $(this).prop("id");
  
closeDailyHover();

  
  
    $("#" + dailyRightClicked).append(
      "<div class='dailyListItemRightContainer'><div class='dailyListItemRight'><span class='dailyListItemEdit'><i class='fa fa-edit'></i></span><span class='dailyListItemDelete'><i class='fa fa-trash'></i></span></div><div class='dailyListEditContainer'></div></div>"
    );
  }
});

$(document).on("mouseleave", ".dailyListItem", function() {
  $(".dailyListItemRight").fadeOut(300, function() {
    $(this).remove();
  });
});

$(document).on("mousedown", ".dailyListItemRight", function(event) {
  if (event.which === 3) {
    $(".dailyListItemRight").fadeOut(300, function() {
    $(this).remove();
  });
  
  
  }
});  


// DAILY REMOVE FUNCTION

$(document).on("click", ".dailyListItemDelete", function(){
let itemId = $(this).parent().parent().parent().prop("id");
let dailyClicked = "";
for(i=0;i<dailySave.length;i++){
if(itemId == "dailyListItem" + dailySave[i].id) {
dailyClicked = dailySave[i];
}

}
if (confirm('Are you sure you want to delete your "' + dailyClicked.title + '" daily?')) {
 $(this).parent().parent().parent().remove();
 // SAVE PROGRESS OF DAILIES?
   if(itemId == "dailyListItem" + dailyClicked.id && dailySave[i].progress >= 5) {
     dailySave[i].status = "inactive";
   } else if (itemId == "dailyListItem" + dailyClicked.id) {
     // REMOVE FROM OBJECT
     dailyClicked.status = "should be deleted! Do not know yet how!";
   }

  dailyCurrent-= 1;  
  
  if (dailyCurrent === 0) {
$(".dailyListAddContainer, .dailyListAdd").css("opacity", "0.6");
} else if(dailyCurrent >= dailyMax) {
    dailyCurrent = dailyMax;
    $(".dailyListAddContainer").hide();
   } else {
    $(".dailyListAddContainer").show(); }
} 

});

var dailyCategory = "";

// DAILY EDIT!
$(document).on("click", ".dailyListItemEdit", function() {
  let dailySaveCurrent;
  dailyEditRightClicked = $(this).parent().parent().parent().prop("id");
  // works only for the first ten ids!
  let dailyEditId = dailyEditRightClicked.substr(dailyEditRightClicked.length - 1);
  
  
  // make decent edit function! hier
  // DAILY EDIT OPEN 	
 for(i=0;i<dailySave.length;i++){
 if(dailySave[i].id == dailyEditId) {
    dailySaveCurrentTemporary = dailySave[i];
 }
 }
 let descriptionRandom = "";
   if (dailySaveCurrentTemporary.description !== "") {
   descriptionRandom = dailySaveCurrentTemporary.description;
   } else {
   let descriptionText = ["Why do you want to do this?", "Specify what you want to do will make it easier to reach it!", "What did you learn from this habit?"];
   descriptionRandom = descriptionText[Math.floor(Math.random()*descriptionText.length)];
   }
  $(".growContainer").append('<div class="growContainerFade"></div><div class="dailyListItemEditContainer"><h1>'+ dailySaveCurrentTemporary.title +'</h1><span>Title:</span><br><input class="dailyListItemEditTitle" placeholder="'+ dailySaveCurrentTemporary.title +'" type="text"></input><br><span>Add some notes:</span><br><textarea class="dailyListItemEditDescription"  placeholder="'+ descriptionRandom +'" rows="4" cols="50"></textarea><br><form class="dailyItemEditDifficulty"><input type="radio" name="difficulty" value="easy"> Easy<input type="radio" name="difficulty" value="medium" checked> Medium<input type="radio" name="difficulty" value="hard"> Hard</form> <br><div class="dailyListItemEditCategoryContainer"><div id="dailyListItemEditCategorySocial"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/social_icon_h4tyqj_cdn7p8.png"/></div><div id="dailyListItemEditCategoryExperience"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/experience_icon_se3gbn_becclk.png"/></div><div id="dailyListItemEditCategoryKnowledge"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/knowledge_icon_rdehej_z3la6e.png"/></div><div id="dailyListItemEditCategorySkills"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/skills_icon_exdkwy_jf50lg.png"/></div><div id="dailyListItemEditCategoryHealth"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/health_icon_bfprxq_x7s3dz.png"/></div><div id="dailyListItemEditCategoryOther"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498817105/random_dice_yyciha.png"/></div></div><br><span class="dailyListItemEditSaveButton">Save &amp; Close</span><span class="dailyListItemEditCancelButton">Just Close</span></div>');
  $(".dailyListItemEditContainer").css("height","700px"); //doesnt animate yet


  //Put correct difficulty level
  if(dailySaveCurrentTemporary.difficulty == "easy"){
  $('.dailyItemEditDifficulty :radio[value=easy]').attr('checked', true);
  //set to easy
  } else if (dailySaveCurrentTemporary.difficulty == "hard"){
  $('.dailyItemEditDifficulty :radio[value=hard]').attr('checked', true);
  //set to hard
  } else {
  $('.dailyItemEditDifficulty :radio[value=medium]').attr('checked', true);
  //set to medium, default
  }
  
  // take first letter and turn it to uppercase
  let categoryUpperCase = "#dailyListItemEditCategory" + (dailySaveCurrentTemporary.category).substr(0,1).toUpperCase() + (dailySaveCurrentTemporary.category).substr(1,dailySaveCurrentTemporary.category.length);
  $(categoryUpperCase).addClass("itemEquipped"); 
  
  
 // select category 
  $(document).on("click", ".dailyListItemEditCategoryContainer div ", function() {
  $(this).parent().children().removeClass("itemEquipped");
  $(this).addClass("itemEquipped");
  let categoryClickedClass = $(this).prop("id");
  for(i=0;i<statName.length;i++){
  if(categoryClickedClass.toLowerCase().indexOf(statName[i]) >= 0){
  $.extend(true, dailySaveCurrentTemporary, {category: statName[i]});
  } 
  }
  
  // END CATEGORY SELECTION
 });
  
  // just close without save
  $(document).on("click",".dailyListItemEditCancelButton", function() {
  ($(".dailyListItemEditContainer")[0]).remove();
  $(".growContainerFade").remove();
  });
  
  // close on escape without save
  if($(".dailyListItemEditSaveButton")[0]){
  $(document).keyup(function(e) {
  if (e.keyCode === 27) {
  $('.dailyListItemEditCancelButton').click();
  }   
});
  }
  // save and close
  $(document).on("click", ".dailyListItemEditSaveButton", function() {
  let dailyNewTitle = $(".dailyListItemEditTitle").val();
  let dailyNewDescription = $(".dailyListItemEditDescription").val();
  let dailyNewDifficulty = $('input[name=difficulty]:checked', '.dailyItemEditDifficulty').val();
  $.extend(true, dailySaveCurrentTemporary, {difficulty: dailyNewDifficulty});
  ($(".dailyListItemEditContainer")[0]).remove();
  $(".growContainerFade").remove();
  
  // change variables
  if (dailyNewTitle.length > 0) {
  $("#" + dailyEditRightClicked +" .dailyListItemTitle").text(dailyNewTitle);
  $.extend(true, dailySaveCurrentTemporary, {title: dailyNewTitle});
  }
  if (dailyNewDescription.length > 0) {
   $.extend(true, dailySaveCurrentTemporary, {description: dailyNewDescription});
  }
  
  //update list again
  dailyListUpdate(true);
  });
  
  
  
  // cancel
  
  
  
  });

 
 
 
 
 
 
 // CALL FUNCTION TO LOAD Dailies
 dailyListUpdate(true);
 
 
  
  // SKILLS IN TRAINING / HABITS HERE  
  
 $(document).on("click", ".habitListAddContainer", function(){
  $(this).hide();
  
  //
  $(".habitList").append('<li class="habitListItemTemporary"><input type="text" class="habitListAddTitle"></input></li>');
  $(".dailyListAddTitle").focus();
});

$(document).on("keypress", ".habitListAddTitle", function(input) {
  let habitTitle = $(".habitListAddTitle").val();
 
  if (input.keyCode == 13 && habitTitle.length >= 3) {
    
    // Save for reloading;
    habitSave.push({
      id: habitId,
      title: habitTitle,
      gold: 5,
      experience: 5,
      progress: 0, //number of times you already succeeded
    });
    
    // Remove temporary list and replace it with new habit
    $(".habitListItemTemporary").remove();
    
    habitListUpdate();
    
    // Add individual id to each habit
    habitId++;
    
   // Make habit add function available again if you didn't exceed the max amount of the list;
   habitCurrent++;
    
   if(habitCurrent >= habitMax) {
    habitCurrent = habitMax;
    $(".habitListAddContainer").hide();
   } else {
    $(".habitListAddContainer").show(); }
  }});

function habitListUpdate(reload) {
  
  // RELOAD LIST COMPLETELY! 
  if(reload) {
  for (i=0;i<habitSave.length;i++){
   $(".habitList").append('<li class="habitListItem" id="' + habitSave[i].id + '">' + habitSave[i].title  + '<span class="habitListItemDone"></span></li>');
  }
  } else { 
   // RELOAD LAST ADDED ITEM! 
   $(".habitList").append('<li class="habitListItem" id="' + habitSave[habitSave.length -1].id + '">' + habitSave[habitSave.length - 1].title  + '<span class="habitListItemDone"></span></li>');
  }
}


// Habit DONE
$(document).on("click", ".habitListItemDone", function(){
 let habitClicked = $(this).parent().prop("id");
  
  if($(this).children().hasClass("habitChecked")){  
    
  // REMOVE Habit CHECKED!
} else {
 $(this).append('<i class="fa fa-check habitChecked"></i>'); 
 
 // Allow for random drops to happen
  randomDrop("low");
  
 for (i=0; i<habitSave.length;i++){
   if(habitClicked == habitSave[i].id){
     gold += habitSave[i].gold;
     experienceOne += habitSave[i].experience;
     habitSave[i].progress += 1;
     $(this).parent().css("opacity", "0.3");
     health += 2 + ((maxHealth - health) / 10) // replenish base value + 10% of missing health
     }}}});
	 
  
  
  
  
  
  
  
  habitListUpdate(true);
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


// TO-DO LIST toDo 

$(".masterList").sortable({
  axis: "y",
  containment: ".masterList",
  cursor: "move",
});



function toDoUpdate(reload){
  
  // RELOAD WHOLE LIST IF RELOAD = TRUE
  if(reload){
  for(i=0;i<toDoListSave.length;i++){
  $(".toDoList").append(
      '<li class="toDoListItem">' + toDoListSave[i].title +
        '<span class="toDoListItemDone"></span></li>');} 
  
  } else {
    
    // RELOAD LAST ADDED ITEM
     $(".toDoList").append(
      '<li class="toDoListItem">' + toDoListSave[toDoListSave.length -1].title +
        '<span class="toDoListItemDone"></span></li>');
  }
  
       
    
  
}

function masterListUpdate(reload){
  
  // RELOAD WHOLE LIST IF RELOAD = TRUE
  if(reload){
  for(i=0;i<masterListSave.length;i++){
  $(".masterList").append(
      "<li class='masterListItem' id='"+ masterListSave[i].masterListId +"'value='" +
        masterListSave[i].masterListTitle +
        "'><span class='masterListItemTitle'>" + 
        masterListSave[i].masterListTitle +
        "</span><span></span>" +
        masterListSave[i].masterListDeadline + "</li><ol id='masterListStepList"+ masterListSave[i].masterListId +"'></ol>"
    );
  }
  } else {
    $(".masterList").append(
      "<li class='masterListItem' id='"+ masterListSave[masterListSave.length - 1].masterListId +"'value='" +
        masterListSave[masterListSave.length - 1].masterListTitle +
        "'><span class='masterListItemTitle'>" + 
        masterListSave[masterListSave.length - 1].masterListTitle +
        "</span><span></span>" +
        masterListSave[masterListSave.length - 1].masterListDeadline + 
		"<span class='masterListAddSteps'><i class='fa fa-plus'></i></span></li><ol id='masterListStepList"+ masterListSave[masterListSave.length - 1].masterListId +"'></ol>"
    );
  }
}
// Transfer from to-do to masterlist


$(document).on("click", ".masterListTransfer", function() {
  $(".toDoContainer, .masterListTransfer").css("width", "0");
  $(".masterListContainer").css("width", "360px");
  $(".toDoListTransfer").css("width", "20px");
  $(".toDoContainer h1, .toDoContainer ul").fadeOut();
  $(".masterListContainer h1, .masterListContainer ul").fadeIn();
});

$(document).on("click", ".toDoListTransfer", function() {
  $(".masterListContainer, .toDoListTransfer").css("width", "0");
  $(".toDoContainer").css("width", "360px");
  $(".masterListTransfer").css("width", "20px");
  $(".masterListInput").fadeOut("0");
  $(".toDoContainer h1, .toDoContainer ul").fadeIn();
  $(".masterListContainer h1, .masterListContainer ul").fadeOut();
});


// ADD TO-DO to MasterList



// ADD Master List Item 
$(document).on("click", ".masterListAddContainer", function(){
  $(this).hide();
  $(".masterList").append('<li class="masterListItemTemporary"><input type="text" placeholder="Pour your heart in" class="masterListAddTitle" maxLength="25" /><span class="masterListDuration"><input class="masterListDeadline" type="date" /></li>');
  $(".masterListAddTitle").focus();
  // PUTTING TODAY AS DEFAULT DATE
  let now = new Date();

  let day = ("0" + now.getDate()).slice(-2);
  let month = ("0" + (now.getMonth() + 1)).slice(-2);

  var today = now.getFullYear() + "-" + month + "-" + day;

  $(".masterListDeadline").val(today);
});   

$(document).on("keypress", ".masterListAddTitle", function(input) {
  let masterListItemTitle = $(".masterListAddTitle").val(),
      masterListDeadline = $(".masterListDeadline").val();
    masterListId++;
 
  if (input.keyCode == 13 && masterListItemTitle.length >= 3) {
    
    // Save for reloading;
    masterListSave.push({
      masterListId: masterListId,
      masterListTitle: masterListItemTitle,
	  masterListDeadline: masterListDeadline,
    });
    
	
    // Remove temporary list and replace it with new masterlist Item
    $(".masterListItemTemporary").remove();
    
   masterListUpdate();
    
  $(this).show();
  $(".masterListTitle").val("");
  $(".masterListDeadline").val(today);
  }});
  

  
// IF MOUSE MOVES OUT OF CONTAINER REMOVE ADD CONTAINER  
if(".masterListItemTemporary".length > 0) {
$(document).on("mouseleave", ".interfaceQuadrant", function(){
 $(".masterListItemTemporary").remove();
 $(".masterListAddContainer").show();
});


}  



// END MASTERLIST ADD



// ADD ADDITIONAL STEPS TO MASTERLIST
$(document).on("click", ".masterListAddSteps", function(){
  let listId = $(this).parent().prop("id");
  console.log("#masterListStepList" + listId)
  
  $("#masterListStepList" + listId + "").append('<li class="masterListStep"><input type="text" class="masterListStepTitle"></input></li>');
  $(".masterListStepTitle").focus();
});







// Scroll the importance // without scrolling! Problemkind
var masterListCurrentScroll = 0,  masterListScrollSpeed = 150;

document.addEventListener('scroll', function (event) {
  if (event.target.hasClass("sideBar")) {     
       console.log(victory);
       event.preventDefault();
       var st = $(this).scrollTop();
       
       if(Math.abs(masterListCurrentScroll - st) <= masterListScrollSpeed)
          return;
       
       if (st > masterListCurrentScroll){
           // downscroll code
           console.log('scroll down');
       } else {
          // upscroll code
          console.log('scroll up');
       }
       masterListCurrentScroll = st;
    }
}, true );

  




// MASTER LIST RIGHT CLICK!
$(document).on("mousedown", ".masterListItem", function(event) {
  if (event.which === 3 && $(".masterListItemRight").length === 0) {
    $(this).append(
      "<div class='masterListItemRightContainer'><div class='masterListItemRight'><div class='masterListItemRightAdd'><i class='fa fa-arrow-left'></i></div><span class='masterListItemRightEdit'><i class='fa fa-edit'></i></span><span class='masterListItemRightDelete'><i class='fa fa-trash'></i></span></div><div class='masterListEditContainer'></div></div>"
    );
	    
  }
});

$(document).on("mouseleave", ".masterListItem", function() {
  $(".masterListItemRight").fadeOut(300, function() {
    $(this).remove();
  });
});

$(document).on("mousedown", ".masterListItemRight", function(event) {
  if (event.which === 3) {
    $(".masterListItemRight").fadeOut(300, function() {
    $(this).remove();
  });
  }
});  

// REMOVE TODO  (update to remove values from masterListsave!)
$(document).on("click", ".masterListItemRightDelete", function() {
  $(this).parent().parent().parent().fadeOut(300, function() {
    // REMOVE ITEM FROM MASTERLISTSAVE!
    let masterListItemText = $(this).text().slice(0, 3);
    for (i = 0; i < masterListSave.length; i++) {
      if (masterListSave[i].masterListTitle.includes(masterListItemText)) {
        delete masterListSave[i];
      }

      break;
    }
    $(this).remove();
  });
  
  // IF MasterListItem cant be found add Container permanent, should not stay permanent if there is more items
if ($(".masterListItem")[0]) {
$(".masterListAddContainer, .masterListAdd").show().css("opacity", "0.6");
} 
  
});

// SEND TODO FROM MASTERLIST TO TODO LIST
$(document).on("click", ".masterListItemRightAdd", function() {
  if (toDoMax < 3) {
    let title = $(this).closest(".masterListItem").attr("value");
    toDoListSave.push({"title": title,});
    toDoUpdate();
    
    $(this).parent().parent().parent().fadeOut(300, function() {
      $(this).remove();
    });
    // MAX 3 TO DO'S per day
    toDoMax++;
  }
    // IF MasterListItem cant be found add Container permanent
if ($(".masterListItem")[0]) {
$(".masterListAddContainer, .masterListAdd").css("opacity", "0.6");
} 
});








// EDIT FUNCTION!
$(document).on("click", ".masterListItemRightEdit", function() {
  if($(".masterListEditContainer").hasClass("masterListEditContainerOpen")) {
   $(".masterListEditContainer").removeClass("masterListEditContainerOpen");
    $(this).parent().remove();
  }
  
  else {
    $(".masterListEditContainer").addClass("masterListEditContainerOpen");
     $(this).parent().remove();
  }
 
  
});

// EDIT TITLE
$(document).on("click", ".masterListItemTitle", function(){
  
});










// To Do List item done
$(document).on("click", ".toDoListItemDone", function() {
  // REMOVE ITEM FROM MASTERLISTSAVE
  let toDoListItemText = $(this).text().slice(0, 3);

  for (i = 0; i < toDoListSave.length; i++) {
    if (toDoListSave[i].title.includes(toDoListItemText)) {
      delete toDoListSave[i];
    }
  }
  $(this).append('<i class="fa fa-check toDoChecked"></i>');
  
  // REMOVE AFTER GIVEN TIME, Problemkind!
  $(this).parent().fadeOut("slow", function() { $(this).remove(); });
  experienceOne += 5;
  update();

  // toDo List Item done
  if ($(this).parent().hasClass("toDoListItem")) {
    toDoMax--;
  }
  
  // Allow for random drops to happen
  randomDrop("low");
});



masterListUpdate(true);




// PET FUNCTIONS

function addPet(position) {
// append pet 
$(".shopPetList").append("<li><img class='petImage' alt='"+ pet[position].name +"' src='"+ pet[position].source +"'</li>");
$('img[alt="' + pet[petEquipped].name + '"').addClass("petImageEquipped");
};


// click on pet in pet
$(document).on("click", ".petImage", function(){
  let petName = $(this).prop("alt"),
      petPrev = "",
	  petPrevCheck = "";
  
 // remove pet that was automatically loaded 

$('img[alt="shopPet').remove();
 
  for(i=0;i<pet.length;i++){
  
  if (pet[i].equipped === true) {
  // REMOVE PET FROM LIST AND IMAGELIST  (unequip doesnt work when there is only one pet)
  $.extend(true, pet[i], {equipped: false});
  petEquipped = "";
  petPrev = pet[i].name;
  petPrevCheck = pet[i].name;
  $('.itemPreview > img[alt="' + pet[i].name + '"').remove();
  $('img[alt="' + pet[i].name + '"').removeClass("petImageEquipped");
  } 
  }
  
  for(i=0;i<pet.length;i++){
  // Equip new pet
  
  // pet 
  if(petName == pet[i].name && petName !== petPrev){
  $(this).addClass("petImageEquipped");
  petEquipped = pet[i].number;
  $.extend(true, pet[i], {equipped: true});
  if (petPrev == ""	){
  petPrev = 1;
  }
   $(".itemPreview").append(
      "<img src='" +
        pet[i].source +
        "' alt='" +
        pet[i].name +
        "' style=' width:" + pet[i].size[0] + "px; height:" + pet[i].size[1] +  
        "px; position:absolute;top:"+ pet[i].coordinates[0] +"px;left:"+ pet[i].coordinates[1] + "px; z-index:"+ pet[i].layer + "'>");
  };
  
  }
  
  // accustom pet, move avatar around only if there is a change 
  // how do i register change?
 if (petPrev == 1 || petName == petPrev) {
  avatarImageLoad("shop");
  }
  
});


// PET GROWTH FUNCTIONS  doesnt grow yet, only when changed from other pet
function petGrowth(petId, grow, shrink, sizeX, sizeY){

let petSizeX = pet[petId].size[0],
    petSizeY = pet[petId].size[1];
	
	//grow in percent!
if (grow>0){
    petSizeX =  pet[petId].size[0] + Math.floor(grow / 100 * pet[petId].size[0]);
    petSizeY =  pet[petId].size[1] + Math.floor(grow / 100 * pet[petId].size[1]);
	//shrink in percent!
} else if (shrink>0){
    petSizeX =  pet[petId].size[0] - Math.floor(shrink / 100 * pet[petId].size[0]);
    petSizeY =  pet[petId].size[1] - Math.floor(shrink / 100 * pet[petId].size[1]);
	//absolute size!
	} else if (sizeX > 0 && sizeY > 0) {
    petSizeX = sizeX;
    petSizeY = sizeY;
}

$.extend(true, pet[petId], {
  size: [petSizeX,petSizeY]
});

}


// PET FOOD

function updatePetFood () {
$("#petWhiteFood > .shopPetFoodAmount").text(itemsOwned.usables.petWhiteFood);

}

updatePetFood();



// PET FOOD DRAG AND DROP SYSTEM
function petFoodDrag(status) {
 
  if (status == "enable") {
  $(".shopPetFoodListItem").draggable({
    containment: ".itemContainer",
    revert: true
  });

  $(".petImage").droppable({
    hoverClass: "itemEquipped",
    drop: petFoodDrop,
  });
  
  } else if (status == "disable") {
  $(".shopPetFoodListItem").draggable({ disabled: true });          

  }
}

function petFoodDrop(event, ui) {
  
  var draggable = ui.draggable;
  /*
  draggable.fadeOut(500, function(){
  draggable.fadeIn(500);
  });
  */
  
  let foodCategory = draggable.prop("id");
  let droppedOn = $(this).prop("alt");
  let droppedOnPosition = -1;
  let droppedOnEquipped = false;
  for (i=0;i<pet.length;i++){
  if(droppedOn == pet[i].name) {
  droppedOnPosition = pet[i].number;
  droppedOnEquipped = pet[i].equipped;
  }
  }
 
  
  // substitute with more adaptive function that finds index of food in usables
  
  if (foodCategory == "petWhiteFood" && itemsOwned.usables.petWhiteFood > 0) {
  if (droppedOn.indexOf("white") > -1) {
  petGrowth(droppedOnPosition, 10);
  alert("Your pet really likes it");

  
  } else if(itemsOwned.usables.petWhiteFood > 0){
  alert("It looks like it is saying: 'Well, it's definitely food!");
  petGrowth(droppedOnPosition, 7);
  }
  itemsOwned.usables.petWhiteFood -= 1
  
  }
  updatePetFood();
  
  if (droppedOnEquipped === true) {
  avatarImageLoad("shop");
    // let pet hop two times
  $(".shopPet").css({
      animation: "shopPetJump " + 0.8 + "s linear"
    });
  }
  
}

$(document).on("mouseover", ".shopPetFoodListItem", function(){
let foodName = $(this).prop("id");
let foodAmount = eval("itemsOwned.usables." + foodName);

if (foodAmount > 0) {
petFoodDrag("enable");
} else if (foodAmount == 0) {
petFoodDrag("disable");
}

});






// DROPS!!! 

// 1% chance of getting a legendary item  
// 10% chance of getting a rare item 
// 20% chance of getting an item - pet, health potion, random item, 


// RANDOM CALCULATOR 	
function randomDrop(dropChance) {
let randomNumber = Math.floor(Math.random()*10000);


if (dropChance == "low") {

if(randomNumber <= 50) {
alert("legendaryDrop - Itemshard of spear of Longinus");
negativeRecency = 0; // negative recency tries to match players expectation with random drops
} else if (randomNumber > 50 && randomNumber <= 500) {
if(negativeRecency >= 8)  {
alert("legendaryDrop - Itemshard of spear of Longinus");
} else {
alert("rareDrop - Cool item");
}
negativeRecency = 0;
} else if (randomNumber > 500 && randomNumber <= 2500) {
if(negativeRecency >= 8)  {
alert("rareDrop - Cool item");
negativeRecency = 0;
} else {
let randomDrop = Math.floor(Math.random()*6 + 1);

if (randomDrop <=3) {
alert("A Healthpotion was dropped!");
itemsOwned.usables.healthPotion++;
updateUsables();

} else if (randomDrop <=5){
alert("A key was dropped! Treasure awaits!");
key++;
} else if (randomDrop == 6) {
alert("A treasure box was dropped!");
itemsOwned.usables.treasureChest++;
}







}

} else {
 negativeRecency++
}


}

// drop chance low, medium, high
}




// Shop Usables!
$(".shopUsablesList").append('<li><div class="usablesListImageContainer"><img class="usablesListImage" id="healthPotion" alt="healthPotion" src="http://res.cloudinary.com/gionisos/image/upload/v1490633862/healthPotionTest_hjdzz2.png"></img><span class="usablesListImageText">'+ itemsOwned.usables.healthPotion +'</span></div></li>  <li><div class="usablesListImageContainer"><img class="usablesListImage" id="treasureChest" alt="treasureChest" src="http://res.cloudinary.com/gionisos/image/upload/v1498143174/treasure_tngevq.png"></img><span class="usablesListImageText">'+ itemsOwned.usables.treasureChest +'</span></div></li> <li><div class="usablesListImageContainer"><img class="usablesListImage" id="keys" alt="keys" src="http://res.cloudinary.com/gionisos/image/upload/v1498143067/golden-key1_jxxufv.png"></img><span class="usablesListImageText">'+ itemsOwned.usables.keys +'</span></div></li>');



function randomItem() {
// decide which category you will get an item from - pet or equipment for now
let randomCategory = Math.floor(Math.random() * 3 +1);

if (randomCategory <= 2) {
// pet
let petNumbersAll = []
// make itemlist with pets you do not have yet // seems a bit inefficient at this point :p
for (i=0;i<pet.length;i++) {
petNumbersAll.push(i);

}
// subtract lists from each other to be left with pets you do not yet have
let randomPet = petNumbersAll.filter(function( el ) {
  return itemsOwned.pets.indexOf( el ) < 0;
} );

// randomly take one of the pets
let randomPetIndex = Math.floor(Math.random() * randomPet.length);
itemsOwned.pets.push(randomPet[randomPetIndex]);
addPet(randomPet[randomPetIndex]);

// call popup menu to show you what you got
let popUpDropText = pet[randomPet[randomPetIndex]].name.toUpperCase();

$(".mainScreen").append("<div class='popUpNewStuff'><img class='popUpImage' src='"+ pet[randomPet[randomPetIndex]].source +"'><span>You have got a new pet!<br>"+ popUpDropText +"</span><br><span class='popUpContinue'>Yay!</span></div>");
$(".popUpNewStuff").hide().fadeIn("slow");
} else if (randomCategory = 3) {
//equipment
// pet
let equipmentNumbersAll = []
// make itemlist with pets you do not have yet // seems a bit inefficient at this point :p
for (i=0;i<itemPlayGround.length;i++) {
equipmentNumbersAll.push(i);

}
// subtract lists from each other to be left with pets you do not yet have
let randomEquipment = equipmentNumbersAll.filter(function( el ) {
  return itemsOwned.equipment.indexOf( el ) < 0;
} );

// randomly take one of the pets
let randomEquipmentIndex = Math.floor(Math.random() * randomEquipment.length);
itemsOwned.equipment.push(randomEquipment[randomEquipmentIndex]);
addItem(randomEquipment[randomEquipmentIndex]);

// call popup menu to show you what you got
let popUpDropText = itemPlayGround[randomEquipment[randomEquipmentIndex]].name.toUpperCase();

$(".mainScreen").append("<div class='popUpNewStuff'><img class='popUpImage' src='"+ itemPlayGround[randomEquipment[randomEquipmentIndex]].source +"'><span>You have got a new piece of equipment!<br>"+ popUpDropText +"</span><br><span class='popUpContinue'>Yay!</span></div>");
$(".popUpNewStuff").hide().fadeIn("slow");
}
}

$(document).on("click", ".popUpContinue", function(){
$(this).parent().fadeOut("slow", function(){$(this).remove();});
});


function updateUsables(){

// Healthpotions
if(itemsOwned.usables.healthPotion > 0) {
$("#healthPotion").addClass("itemEquipped");
$("#healthPotion ~ .usablesListImageText").html(itemsOwned.usables.healthPotion);
} else {
itemsOwned.usables.healthPotion = 0;
$("#healthPotion").removeClass("itemEquipped");
$("#healthPotion ~ .usablesListImageText").html(itemsOwned.usables.healthPotion);
}

// treasureChest
if(itemsOwned.usables.treasureChest > 0) {
$("#treasureChest").addClass("itemEquipped");
$("#treasureChest ~ .usablesListImageText").html(itemsOwned.usables.treasureChest);
} else {
itemsOwned.usables.treasureChest = 0;
$("#treasureChest").removeClass("itemEquipped");
$("#treasureChest ~ .usablesListImageText").html(itemsOwned.usables.treasureChest);
}

// keys
if(itemsOwned.usables.keys > 0) {
$("#keys").addClass("itemEquipped");
$("#keys ~ .usablesListImageText").html(itemsOwned.usables.keys);
} else {
itemsOwned.usables.keys = 0;
$("#keys").removeClass("itemEquipped");
$("#keys ~ .usablesListImageText").html(itemsOwned.usables.keys);
}



}



updateUsables();


$(document).on("click", ".usablesListImage", function(event){

if(event.target.id == "healthPotion" && health < maxHealth){
// ask if you want to use healthpotion?
itemsOwned.usables.healthPotion -= 1;
health += 25;
update();

}


if(event.target.id == "treasureChest" && itemsOwned.usables.keys >= 3) {

// minus one treasure chest and three keys
itemsOwned.usables.treasureChest -= 1;
itemsOwned.usables.keys -= 3;
// open treasureChest, generate random item
randomItem();
}


updateUsables();
});






// thoughts on click of avatar based on relevance!

var situation = 2;

$(document).on("click", ".avatarContainer > img", function() {

if (situation == 1) {
avatarThoughtBubble("", "You <br> go girl!");
$(".avatarThoughtText").css("top","14px");
}

if (situation = 2) {
avatarThoughtBubble("", "Good Night Sir!");
$(".avatarThoughtText").css("top","8px");
}

});

/*
// Random thought machine
let randomThought = Math.floor(Math.random()*5 + 1);
if(randomThought == 1) {
avatarThoughtBubble("", "Let's work <br>hard today!");
$(".avatarThoughtText").css("top","15px").css("left","15px").css("font-size","12px").css("width","80px");
} else if (randomThought == 2) {
avatarThoughtBubble("", "You <br> go girl!");
$(".avatarThoughtText").css("top","14px");
} else if (randomThought == 3) {
avatarThoughtBubble("", "Did you <br>change <br> me again?!");
$(".avatarThoughtText").css("top","5px").css("left","16px").css("font-size","12px").css("width","80px");
} else {
avatarThoughtBubble("http://res.cloudinary.com/gionisos/image/upload/v1498554629/dfd7ea8238dd73917a14828c2cc2bdd5_oadytb.jpg");
$(".avatarThought").css("top","5px");
}
*/




// EVENTS
function levelUpEvent() {
  switch (level) {
    case 1:
      $(".eventList").append("<li>Welcome to Arya!</li>");
      break;
    case 2:
      $(".eventList").append(
        "<li>You got your first level up! Congratulations!</li>"
      );
      break;
    case 3:
      $(".eventList").append("<li> You unlocked the market! </li>");
      break;
  }
}

// LOADING BASE VALUES
$(document).ready(function() {
  update();
});




// UPDATE FUNCTION

function update() {
  // CHECK FOR LEVEL UP
  if (
    experienceOne >= experienceOneNeeded &&
    experienceTwo >= experienceTwoNeeded
  ) {
    level++;
    levelUpEvent();
    health = maxHealth;
    experienceOne -= experienceOneNeeded;
    experienceTwo -= experienceTwoNeeded;
  }

  // LOAD LEVEL
  $(".level").html(level);

  // LOAD EXPERIENCE BARS
  // 1
  let experienceOnePercentage = experienceOne / experienceOneNeeded * 100;
  $(".experienceSpanOne").css("width", +experienceOnePercentage + "%");
  $(".experienceSpanOne").css("background-color", "#FF851B");
  
  // Experience bar should get slightly more salient when behind! color or opacity
  if(experienceOne > experienceTwo){
   $(".experienceSpanTwo").css("background-color", "#FFDC00");
   
  }
  
  // 2
  let experienceTwoPercentage = experienceTwo / experienceTwoNeeded * 100;
  $(".experienceSpanTwo").css("width", +experienceTwoPercentage + "%");

  if(experienceTwo > experienceOne){
  $(".experienceSpanOne").css("background-color", "#FF972E");
  $(".experienceSpanTwo").css("background-color", " #F2D10D");
  
  }
  
  
  // HEALTH FUNCTIONS

  // HEALTH BOUNDARIES - DYING AND MAXHEALTH

  if (health <= 0) {
    alert("You just died!");
    health = maxHealth;
  }

  if (health > maxHealth) {
    alert("max health!");
    health = maxHealth;
  }

  // LOADING HEALTH BACKGROUND
  healthPercentage = health / maxHealth * 100;

  let colorMinus = 255 - healthPercentage * 2;

  $(".avatarContainer").css({
    "background-image": "radial-gradient(ellipse farthest-corner at 50% 50%, rgba(" +
      colorMinus +
      ", 0, 0, 0.2) 10%, rgba(0," +
      Math.floor(healthPercentage * 2.5)+
      ",0, 0.8) 90%)"
  });
  
  
  // HEALTH EVENTS
  if (healthPercentage < 20 && itemsOwned.usables.healthPotion > 0 && !$(".avatarThoughtBubbleContainer")[0]) {
  avatarThoughtBubble("http://res.cloudinary.com/gionisos/image/upload/v1490633862/healthPotionTest_hjdzz2.png");
  }
  
  // END HEALTH EVENTS
  

  // LOAD GOLD
  if (Arya.gold[gold] !== undefined) {
    $(".goldContainer").html(
      "<img src='" + Arya.gold[gold] + "'" + "class='goldImage'>"
    );
  } else {
    $(".goldContainer").text("Gold: " + gold);
  }

  // MARKET - ITEM OF INTEREST
  $(".marketImageContainer").html(
    "<img src='" +
      itemPlayGround[buyOrder[itemOfInterest]].source +
      "'" +
      "class='marketImage' alt='"+ itemPlayGround[buyOrder[itemOfInterest]].name +"'><span class='marketImageText'>Gold: " +
      itemPlayGround[buyOrder[itemOfInterest]].gold +
      "</span>"
  );
} // END UPDATE

// KEY COMMANDS!
// OPEN CONSOLE
$(document).keypress(function(event) {
  if (event.which == 120 && $(".consoleContainer").hasClass("show") !== true) {
    $(".consoleContainer").addClass("show");
  } else {
    $(".consoleContainer").removeClass("show");
  }

  // OPEN ITEM CONTAINER
  if (event.which == 105 && $(".itemContainer").hasClass("show") !== true) {
    $(".itemContainer").addClass("show");
	avatarImageLoad("shop");	
    sortItems();
	loadItemsToBuy();
  } else if (event.which == 105 && $(".itemContainer").hasClass("show") === true) {
    $(".itemContainer").removeClass("show");
	avatarImageLoad("sideBar");
  }

  // OPEN EVENT CONTAINER
  if (event.which == 101 && $(".eventContainer").hasClass("show") !== true) {
    $(".eventContainer").addClass("show");
  } else {
    $(".eventContainer").removeClass("show");
  }

  // OPEN COLOR TEST CONTAINER
  if (event.which == 99 && $(".colorContainer").hasClass("show") !== true) {
    $(".colorContainer").addClass("show");
  } else {
    $(".colorContainer").removeClass("show");
  }

  if (
    event.which == 97 &&
    $(".arenaConsoleContainer").hasClass("show") !== true
  ) {
    $(".arenaConsoleContainer").addClass("show");
  } else {
    $(".arenaConsoleContainer").removeClass("show");
  }

  if (
    event.which == 113 &&
    $(".questConsoleContainer").hasClass("show") !== true
  ) {
    $(".questConsoleContainer").addClass("show");
  } else {
    $(".questConsoleContainer").removeClass("show");
  }
});


//END KEY COMMANDS

// QUEST SYSTEM!

var quest = {
  socialI: [
    {
      day: "1",
      mainTask: "Give a genuine compliment to a stranger (1)",
      oneTimeTask: "Write down three things you like about yourself"
    },
    {
      day: "2",
      mainTask: "Give a genuine compliment to a stranger (2)",
      oneTimeTask: "Write down three things you like about yourself"
    },
    {
      day: "3",
      mainTask: "Give a genuine compliment to a stranger (3)",
      oneTimeTask: "Write down three things you like about yourself"
    }
  ],
  knowledgeI: [
    {
      day: "1",
      mainTask: "Know",
      oneTimeTask: "What"
    },
    {
      day: "2",
      mainTask: "I",
      oneTimeTask: "Know"
    },
    {
      day: "3",
      mainTask: "Now",
      oneTimeTask: "!"
    }
  ]
};

// CURRENT FOCUS QUESTS problemkind

$(document).on("click", ".questConsoleSelectButton", function() {
  let currentQuestNumber = $(".questConsoleSelect")
    .children(":selected")
    .attr("value");
  let currentQuestName = questSet[currentQuestNumber];

  for (i = 0; i < Arya.questMaps[currentQuestNumber].questAmount; i++) {
    let currentQuest = "".concat("quest.", currentQuestName, "[", i, "]");
    
    if (eval(currentQuest + ".mainTask").length > 0) {
      
      $(".questConsoleList").append(
        "<li><div class='questConsoleDay'><p>Day " +
          eval(currentQuest + ".day") +
          "</p><div class='questConsoleMainTask'><span>Main Task: " +
          eval(currentQuest + ".mainTask") +
          "</span><span class='questConsoleMainTaskDone'></span></div><div class='questConsoleOneTimeTask'><span>One-Time-Task: " +
          eval(currentQuest + ".oneTimeTask") +
          "</span><span class='questConsoleOneTimeTaskDone'></span></div></div></li>"
      );
    }
  }
});

$(
  document
).on(
  "click",
  ".questConsoleMainTaskDone, .questConsoleOneTimeTaskDone",
  function() {
    $(this).parent().remove();
    experienceTwo += 5;
    update();
  }
);

// QUEST CONSOLE REMOVE

$(document).on("click", ".questConsoleRemoveButton", function() {
  $(".questConsoleList").empty();
});



}); // END DOCUMENT READY

</script>













<!-- HTML HERE -->









<div class="growContainer">

  <!-- Arena -->
  <div class="arenaOverlay" id="arenaOverlay">
    <div class="arenaContainer">
      <div class="arenaStatContainer"><span class="arenaStat arenaStatSocial"></span><span class="arenaStat arenaStatExperience"></span><span class="arenaStat arenaStatKnowledge"></span><span class="arenaStat arenaStatSkills"></span><span class="arenaStat arenaStatHealth"></span></div>

      <span class="arenaSkillPointsCounter"></span>
      <ul class="arenaAvatarSkillList"></ul>
    </div>
    <div class="arenaContainer"><span class="arenaOpponentSkillPointsCounter"></span>
      <ul class="arenaOpponentSkillList"></ul>
      <div class="opponentAvatarContainer"><canvas id="opponentAvatarCanvas" width="160" height="160"></canvas></div>
    </div>
    
    <canvas id="arenaAnimationCanvas" width="160" height="160"></canvas>
  </div>

  
  <!-- Sidebar -->

  <div class="sideBar">
    <div class="avatarContainerPosition">
      <div class="avatarContainer">
        <div class="healthContainer">
        </div>
        <div class="avatarImageContainer">
        </div>
      </div>
    </div>
    <div class="experienceContainer">
      <div class="levelContainer">
        <span class="level"></span>
      </div>
      <div class="experienceBar experienceBarOne">
        <span class="experienceSpanOne"></span>
      </div>
      <div class="experienceBar experienceBarTwo">
        <span class="experienceSpanTwo">
    </span>
      </div>
    </div>

    <div class="vaultContainer">
      <div class="goldContainer">
      </div>
      <div class="marketContainer">
        <div class="buyApproval">
          <span class="buyButtonYes"> Yes </span> 
          <span class="buyButtonNo"> No </span>
        </div>
        <div class="marketImageContainer">
        </div>
      </div>
    </div>


    <div class="sideBarNavigation">
      <p class="questGlobalButton">Quests</p>
      <p class="arenaButton">Arena</p>
    </div>


  </div>
  <!-- END OF SIDEBAR -->
  <div class="mainScreen">
   
    
    <div class="questBeginnerContainer">
    <canvas id="questBeginnerCanvas" width="768" height="768"></canvas>
      
      <div class="oneTimeActionContainer">
      <span class="oneTimeActionContainerClose">&#10006;</span>
      
        <div class="oneTimeActionTitleContainer"></div>
        <div class="oneTimeActionGoalContainer"></div>
        <div class="oneTimeActionTextContainer"></div>
        <div class="oneTimeActionRewardContainer"></div>
        <div class="oneTimeActionAccept">Accept Quest</div>
        
        
        
        <!-- Add comment section at one point -->
        <div class="oneTimeActionCommentContainer"></div>
      
      
      
      
      </div>
     
    
    </div>
    
    
    
    
    
    
    
    
    
    
    <!-- Quest Test!-->
     <div class="questConsoleContainer">
    <select class="questConsoleSelect">
      <option value="0">Social I - Attention </option>
  <option value="1">Experience I - Getting to know your environment</option>
  <option value="2">Knowledge I - Learning how to learn</option>
  <option value="3">Skills I - A taste of everyday life skills</option>
      <option value="4">Health I - A healthy morning ritual</option>
  </select>
       <button type="button" class="questConsoleSelectButton">LOAD</button>
       <button type="button" class="questConsoleRemoveButton">REMOVE</button>
       
       <ul class="questConsoleList"></ul>
    
    </div>  
        
    
      
    
    
    
        
    
    

    
    
    

    <!-- INTERFACE AKA FIRST LEVEL -->
    <div class="interface">
      <div class="interfaceQuadrant">
        <div class="dailyContainer">
         <h1>Dailies</h1>
          <ul class="dailyList" oncontextmenu="return false">
          </ul>
          <div class="dailyListAddContainer">
          <span class="dailyListAdd"><i class='fa fa-plus'></i></span>
          </div>
          <span class="spreeText">You are on a <span class="spreeNumber"> </span> day spree! </span>
        </div>
      </div>
      
      
      
      <div class="interfaceQuadrant habitContainer">
        <h1> Skills in Training </h1>
		  
		 <ul class="habitList" oncontextmenu="return false"></ul>
	    
		<div class="habitListAddContainer">
          <span class="habitListAdd"><i class='fa fa-plus'></i></span>
          </div>
	  
	  
	  
	    
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
	  
      
      </div>
      <div class="interfaceQuadrant">


        <div class="toDoContainer">
          <h1>To-Do-List</h1>
          
          <ul class="toDoList" oncontextmenu="return false;">
          </ul>


        </div>
        <div class="masterListTransfer"></div>
        <div class="toDoListTransfer"></div>
        <div class="masterListContainer">
          <div class="masterListHeader">
            <h1>All There Is To Do</h1></div>
			
         <ul class="masterList" oncontextmenu="return false;"></ul>
          <div class="masterListAddContainer">
          <span class="masterListAdd"><i class='fa fa-plus'></i></span> 
          </div>		  
          

          </div>
        </div>
        <div class="interfaceQuadrant calendarContainer"></div>


      </div>

      
      
     
      
      
      
      
      <!-- CONSOLE -->
      <div class="consoleContainer">
        <span class="experienceOnePlus">
     XP1+
    </span>
        <span class="experienceTwoPlus">
     XP2+
    </span>

        <span class="healthMinus">
     H-
    </span>
        <span class="healthPlus">
     H+
    </span>

        <span class="goldMinus">
     G-
    </span>
        <span class="goldPlus">
     G+
    </span>

      </div>


      <!-- Arena Console -->
      <div class="arenaConsoleContainer">
        <select class="arenaConsoleSelectOpponent">
  <option value="0">Blob</option>
  <option value="1">Ninja</option>
  </select>
        <span class="arenaConsoleLoadOpponent">load Opponent</span><br>
        <button type="button" class="arenaConsoleButton">Avatar Health +</button><br>
        <button type="button" class="arenaConsoleButton">Avatar Health -</button><br>
        <button type="button" class="arenaConsoleButton">Opponent Health +</button><br>
        <button type="button" class="arenaConsoleButton">Opponent Health -</button>
        <input type="number" class="skillPointsPlus"name="skillPointsPlus" min="1" max="100">
        <input type="submit"class="skillPointsPlusSubmit" value="SkillPoints">
        <input type="submit"class="skillPointsPlusSubmitOpponent" value="Opponent">


      </div>
  

      <div class="itemContainer">
        <div class="shopContainer">
		<div class="itemPreview">
		</div>
		<ul class="avatarEquipped">
          <lh> Avatar Equipment </lh>
          <li class="leftHandEquipped">left hand: </li>
          <li class="rightHandEquipped">right hand: </li>
          <li class="armorEquipped">armor: </li>
          <li class="helmetEquipped">helmet: </li>
          <li class="shoesEquipped">shoes: </li>
        </ul>
		</div>
		
		<div class="shopMenu"><span class="shopUsablesButton">Usables</span><span class="shopEquipmentButton">Equipment</span><span class="shopPetsButton">Pets</span><span>Customization</span><span class="shopBackgroundButton">Backgrounds</span><span>Town</span></div>
		<div class="shopListContainer">
		<div class="shopPetFood"><ul class="shopPetFoodList"><li class="shopPetFoodListItem" id="petWhiteFood"><img src="http://res.cloudinary.com/gionisos/image/upload/v1498420239/cauliflower_chytyv.png" alt="whiteFood" class="shopPetFoodListItemImage"/><span class="shopPetFoodAmount"></span></li></ul></div>
		<ul class="shopUsablesList"></ul>
		<ul class="shopItemList"></ul>
		<ul class="shopPetList"></ul>
		<ul class="shopBackgroundList"></ul>
        </div>
        
      </div>
  
      <div class="eventContainer">
        <ul class="eventList"></ul>
      </div>

      <div class="colorContainer">
        <div class="colorBackground bgBlack"></div>
        <div class="colorBackground bgRed"></div>
        <div class="colorBackground bgOrange"></div>
        <div class="colorBackground bgYellow"></div>
        <div class="colorBackground bgGreen"></div>
        <div class="colorBackground bgPink"></div>
        <div class="colorBackground bgBlue"></div>
        <div class="colorBackground bgWhite"></div>
      </div>
    </div>
    <!-- End Main Screen -->
  </div>
  <!-- End GROW CONTAINER -->
  
 </body>
</html>

